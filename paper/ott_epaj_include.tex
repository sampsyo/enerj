% generated by Ott 0.20.1 from: epaj_common.ott epaj_st.ott epaj_st_wf.ott epaj_rt.ott epaj_rt_wf.ott
\newcommand{\ottdrule}[4][]{{\displaystyle\frac{\begin{array}{l}#2\end{array}}{#3}\quad\ottdrulename{#4}}}
\newcommand{\ottusedrule}[1]{\[#1\]}
\newcommand{\ottpremise}[1]{ #1 \\}
\newenvironment{ottdefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]}{}
\newenvironment{ottfundefnblock}[3][]{ \framebox{\mbox{#2}} \quad #3 \\[0pt]\begin{displaymath}\begin{array}{l}}{\end{array}\end{displaymath}}
\newcommand{\ottfunclause}[2]{ #1 \equiv #2 \\}
\newcommand{\ottnt}[1]{\mathit{#1}}
\newcommand{\ottmv}[1]{\mathit{#1}}
\newcommand{\ottkw}[1]{\mathbf{#1}}
\newcommand{\ottsym}[1]{#1}
\newcommand{\ottcom}[1]{\text{#1}}
\newcommand{\ottdrulename}[1]{\textsc{#1}}
\newcommand{\ottcomplu}[5]{\overline{#1}^{\,#2\in #3 #4 #5}}
\newcommand{\ottcompu}[3]{\overline{#1}^{\,#2<#3}}
\newcommand{\ottcomp}[2]{\overline{#1}^{\,#2}}
\newcommand{\ottgrammartabular}[1]{\begin{supertabular}{llcllllll}#1\end{supertabular}}
\newcommand{\ottmetavartabular}[1]{\begin{supertabular}{ll}#1\end{supertabular}}
\newcommand{\ottrulehead}[3]{$#1$ & & $#2$ & & & \multicolumn{2}{l}{#3}}
\newcommand{\ottprodline}[6]{& & $#1$ & $#2$ & $#3 #4$ & $#5$ & $#6$}
\newcommand{\ottinterrule}{\\[5.0mm]}
\newcommand{\ottafterlastrule}{\\}
\newcommand{\ottmetavars}{
\ottmetavartabular{
 $ \ottmv{i} ,\, \ottmv{j} ,\, \ottmv{k} ,\, \ottmv{n} $ & \multicolumn{1}{l}{\ottcom{index variables as arbitrary elements}} \\
 $ \ottmv{f} $ & \multicolumn{1}{l}{\ottcom{field identifier}} \\
 $ \mathit{mid} $ & \multicolumn{1}{l}{\ottcom{method identifier}} \\
 $ \mathit{pid} $ & \multicolumn{1}{l}{\ottcom{parameter identifier}} \\
 $ \mathit{Cid} $ & \multicolumn{1}{l}{\ottcom{derived class identifier}} \\
 $ \mathit{RAId} $ & \multicolumn{1}{l}{\ottcom{raw address identifier}} \\
 $ \mathit{PrimV} $ & \multicolumn{1}{l}{\ottcom{primitive value}} \\
}}

\newcommand{\ottterminals}{
\ottrulehead{\ottnt{terminals}}{::=}{}\\ 
\ottprodline{|}{ := }{}{}{}{}\\ 
\ottprodline{|}{ \texttt{\upshape{class}\,\!} }{}{}{}{\ottcom{keyword: class declaration}}\\ 
\ottprodline{|}{ \texttt{\upshape{extends}\,\!} }{}{}{}{\ottcom{keyword: super type declaration}}\\ 
\ottprodline{|}{ \texttt{\upshape{new}\,\!} }{}{}{}{\ottcom{keyword: object creation}}\\ 
\ottprodline{|}{ \texttt{\upshape{if}\,\!} }{}{}{}{\ottcom{keyword: if}}\\ 
\ottprodline{|}{ \texttt{\upshape{else}\,\!} }{}{}{}{\ottcom{keyword: else}}\\ 
\ottprodline{|}{ \texttt{\upshape{this}\,\!} }{}{}{}{\ottcom{keyword: current object}}\\ 
\ottprodline{|}{ \texttt{\upshape{null}\,\!} }{}{}{}{\ottcom{keyword: null value}}\\ 
\ottprodline{|}{ \oplus }{}{}{}{\ottcom{syntax: primitive operation}}\\ 
\ottprodline{|}{ \texttt{\{} }{}{}{}{\ottcom{syntax: start block}}\\ 
\ottprodline{|}{ \texttt{\}\,} }{}{}{}{\ottcom{syntax: end block}}\\ 
\ottprodline{|}{ \texttt{(} }{}{}{}{\ottcom{syntax: start parameters}}\\ 
\ottprodline{|}{ \texttt{)} }{}{}{}{\ottcom{syntax: end parameters}}\\ 
\ottprodline{|}{ \texttt{;} }{}{}{}{\ottcom{syntax: separator}}\\ 
\ottprodline{|}{ \texttt{.} }{}{}{}{\ottcom{syntax: selector}}\\ 
\ottprodline{|}{ \texttt{=} }{}{}{}{\ottcom{syntax: assignment}}\\ 
\ottprodline{|}{ \texttt{\upshape{Object}\,\!} }{}{}{}{\ottcom{name of root class}}\\ 
\ottprodline{|}{ \texttt{\upshape{int}\,\!} }{}{}{}{\ottcom{name of primitive type}}\\ 
\ottprodline{|}{ \mathcal{L} }{}{}{}{\ottcom{primitive literal}}\\ 
\ottprodline{|}{ \textsf{$<:_{\mathrm q}$} }{}{}{}{\ottcom{ordering of precision qualifiers}}\\ 
\ottprodline{|}{ \textsf{$<:$} }{}{}{}{\ottcom{subtyping}}\\ 
\ottprodline{|}{ \textsf{$\in$} }{}{}{}{\ottcom{containment judgement}}\\ 
\ottprodline{|}{ \textsf{$\notin$} }{}{}{}{\ottcom{non-containment judgement}}\\ 
\ottprodline{|}{ \textsf{$\vdash$} }{}{}{}{\ottcom{single element judgement}}\\ 
\ottprodline{|}{ \textsf{$\vdash$} }{}{}{}{\ottcom{multiple element judgement}}\\ 
\ottprodline{|}{ \textsf{:} }{}{}{}{\ottcom{separator}}\\ 
\ottprodline{|}{ \mapsto }{}{}{}{\ottcom{maps-to}}\\ 
\ottprodline{|}{ \textsf{OK} }{}{}{}{\ottcom{well-formedness judgement}}\\ 
\ottprodline{|}{ \textsf{=} }{}{}{}{\ottcom{alias}}\\ 
\ottprodline{|}{ \textsf{=} }{}{}{}{\ottcom{option alias}}\\ 
\ottprodline{|}{ \textsf{$\not=$} }{}{}{}{\ottcom{not alias}}\\ 
\ottprodline{|}{ \textsf{=} }{}{}{}{\ottcom{multiple alias}}\\ 
\ottprodline{|}{ \textsf{$\vee$} }{}{}{}{\ottcom{logical or}}\\ 
\ottprodline{|}{ \textsf{$\wedge$} }{}{}{}{\ottcom{logical and}}\\ 
\ottprodline{|}{\ottkw{AND}}{}{}{}{\ottcom{top-level logical and}}\\ 
\ottprodline{|}{ \textsf{$\implies$} }{}{}{}{\ottcom{logical implication}}\\ 
\ottprodline{|}{ \texttt{\upshape{null$_a$}\,\!} }{}{}{}{\ottcom{special null address}}\\ 
\ottprodline{|}{ \rho }{}{}{}{\ottcom{primitive values}}\\ 
\ottprodline{|}{ 0 }{}{}{}{\ottcom{zero value}}}

\newcommand{\ottformula}{
\ottrulehead{\ottnt{formula}}{::=}{\ottcom{formulas}}\\ 
\ottprodline{|}{ \mathrm{otherwise} }{}{}{}{\ottcom{none of the previous rules applied}}\\ 
\ottprodline{|}{\ottnt{judgement}}{}{}{}{\ottcom{judgement}}\\ 
\ottprodline{|}{\ottnt{formula_{{\mathrm{1}}}} \quad \ottsym{,} \quad .. \quad \ottsym{,} \quad \ottnt{formula_{\ottmv{k}}}}{}{}{}{\ottcom{sequence}}\\ 
\ottprodline{|}{ ( \ottnt{formula} ) }{}{}{}{\ottcom{bracketed}}\\ 
\ottprodline{|}{ !  \ottnt{formula} }{}{}{}{\ottcom{negation}}\\ 
\ottprodline{|}{ \ottnt{formula} \ \  \textsf{$\vee$} \ \  \ottnt{formula'} }{}{}{}{\ottcom{logical or}}\\ 
\ottprodline{|}{ \ottnt{formula} \ \  \textsf{$\wedge$} \ \  \ottnt{formula'} }{}{}{}{\ottcom{logical and}}\\ 
\ottprodline{|}{ \hfill  \ottnt{formula}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  \ottnt{formula'} \hfill }{}{}{}{\ottcom{top-level logical and}}\\ 
\ottprodline{|}{\ottnt{formula}  \textsf{$\implies$}  \ottnt{formula'}}{}{}{}{\ottcom{implies}}\\ 
\ottprodline{|}{\overline{^{s}\!fml}}{}{}{}{\ottcom{static formulas}}\\ 
\ottprodline{|}{\overline{^{r}\!fml}}{}{}{}{\ottcom{runtime formulas}}\\ 
\ottprodline{|}{ \forall  \ottmv{f}  \in  \overline{f} .\  \ottnt{formula} }{}{}{}{\ottcom{for all $\ottmv{f}$ in $\overline{f}$ holds $\ottnt{formula}$}}\\ 
\ottprodline{|}{ \forall  \ottnt{C} ,  \ottnt{C'} .\  \ottnt{formula} }{}{}{}{\ottcom{for all $\ottnt{C}$ and $\ottnt{C'}$ holds $\ottnt{formula}$}}\\ 
\ottprodline{|}{ \forall  \iota  \in  \overline{\iota} .\  \ottnt{formula} }{}{}{}{\ottcom{for all $\iota$ in $\overline{\iota}$ holds $\ottnt{formula}$}}\\ 
\ottprodline{|}{ \forall  \iota  \in  \overline{\iota} ,  \ottmv{f}  \in  \overline{\mathit{fv} } .\  \ottnt{formula} }{}{}{}{\ottcom{for all $\iota$ in $\overline{\iota}$ and fields $\ottmv{f}$ in $\overline{\mathit{fv} }$ holds $\ottnt{formula}$}}\\ 
\ottprodline{|}{ \ottnt{h}  \cong  \ottnt{h'} }{}{}{}{\ottcom{two heaps are equal in their precise part}}\\ 
\ottprodline{|}{ v  \cong  v' }{}{}{}{\ottcom{two values are equal in their precise parts}}}

\newcommand{\ottC}{
\ottrulehead{\ottnt{C}}{::=}{\ottcom{class name}}\\ 
\ottprodline{|}{\mathit{Cid}}{}{}{}{\ottcom{derived class identifier}}\\ 
\ottprodline{|}{\texttt{\upshape{Object}\,\!}}{}{}{}{\ottcom{name of base class}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some class name}}}

\newcommand{\ottP}{
\ottrulehead{\ottnt{P}}{::=}{\ottcom{primitive type name}}\\ 
\ottprodline{|}{\texttt{\upshape{int}\,\!}}{}{}{}{\ottcom{integers}}\\ 
\ottprodline{|}{\ottkw{float}}{}{}{}{\ottcom{floating-point numbers}}}

\newcommand{\ottq}{
\ottrulehead{\ottnt{q}}{::=}{\ottcom{precision qualifier}}\\ 
\ottprodline{|}{ \texttt{\upshape{precise}\,\!} }{}{}{}{\ottcom{precise}}\\ 
\ottprodline{|}{ \texttt{\upshape{approx}\,\!} }{}{}{}{\ottcom{approximate}}\\ 
\ottprodline{|}{ \texttt{\upshape{top}\,\!} }{}{}{}{\ottcom{top}}\\ 
\ottprodline{|}{ \texttt{\upshape{context}\,\!} }{}{}{}{\ottcom{context}}\\ 
\ottprodline{|}{ \texttt{\upshape{lost}\,\!} }{}{}{}{\ottcom{lost}}\\ 
\ottprodline{|}{ \mathrm{TQual}\!\left(  T  \right) } {\textsf{M}}{}{}{\ottcom{extract precision qualifier from type}}\\ 
\ottprodline{|}{ \mathrm{MQual}\!\left(  \ottnt{ms}  \right) } {\textsf{M}}{}{}{\ottcom{extract method qualifier from signature}}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \!\!\downarrow_{1} } {\textsf{M}}{}{}{\ottcom{extract environment qualifier}}}

\newcommand{\ottqs}{
\ottrulehead{\overline{q}}{::=}{\ottcom{precision qualfiers}}\\ 
\ottprodline{|}{\ottnt{q_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{q_{\ottmv{n}}}}{}{}{}{\ottcom{precision qualifier list}}\\ 
\ottprodline{|}{ \left\{  \overline{q}  \right\} } {\textsf{M}}{}{}{\ottcom{notation}}}

\newcommand{\ottqC}{
\ottrulehead{\ottnt{qC}}{::=}{\ottcom{qualified class name}}\\ 
\ottprodline{|}{ \ottnt{q} \  \ottnt{C} }{}{}{}{\ottcom{definition}}}

\newcommand{\ottqP}{
\ottrulehead{\ottnt{qP}}{::=}{\ottcom{qualified primitive type}}\\ 
\ottprodline{|}{ \ottnt{q} \  \ottnt{P} }{}{}{}{\ottcom{definition}}}

\newcommand{\ottT}{
\ottrulehead{T}{::=}{\ottcom{type}}\\ 
\ottprodline{|}{ \ottnt{qC} }{}{}{}{\ottcom{reference type}}\\ 
\ottprodline{|}{ \ottnt{qP} }{}{}{}{\ottcom{primitive type}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some type}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} \!\left( \ottnt{x} \right) } {\textsf{M}}{}{}{\ottcom{look up parameter type}}\\ 
\ottprodline{|}{ \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1} } {\textsf{M}}{}{}{\ottcom{look up type in heap}}}

\newcommand{\ottTs}{
\ottrulehead{\overline{T}}{::=}{\ottcom{types}}\\ 
\ottprodline{|}{T_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  T_{\ottmv{n}}}{}{}{}{\ottcom{type list}}\\ 
\ottprodline{|}{ \overline{T}_{{\mathrm{1}}} ,\  \overline{T}_{{\mathrm{2}}} }{}{}{}{\ottcom{two type lists}}\\ 
\ottprodline{|}{ \emptyset }{}{}{}{\ottcom{no types}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some types}}}

\newcommand{\ottPrg}{
\ottrulehead{\ottnt{Prg}}{::=}{\ottcom{program}}\\ 
\ottprodline{|}{ \overline{\mathit{Cls} } ,\  \ottnt{C} ,\  \ottnt{e} }{}{}{}{}}

\newcommand{\ottCls}{
\ottrulehead{\mathit{Cls}}{::=}{\ottcom{class declaration}}\\ 
\ottprodline{|}{ \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \  \ottnt{C} \  \texttt{\{} \  \overline{ \mathit{fd} } \  \overline{ \mathit{md} } \  \texttt{\}\,} }{}{}{}{\ottcom{class declaration}}\\ 
\ottprodline{|}{ \texttt{\upshape{class}\,\!} \  \texttt{\upshape{Object}\,\!} \  \texttt{\{} \texttt{\}\,} }{}{}{}{\ottcom{declaration of base class}}}

\newcommand{\ottClss}{
\ottrulehead{\overline{\mathit{Cls} }}{::=}{\ottcom{class declarations}}\\ 
\ottprodline{|}{\mathit{Cls}_{{\mathrm{1}}} \, .. \, \mathit{Cls}_{\ottmv{n}}}{}{}{}{\ottcom{class declaration list}}}

\newcommand{\ottfds}{
\ottrulehead{\overline{ \mathit{fd} }}{::=}{\ottcom{field declarations}}\\ 
\ottprodline{|}{ T \  \ottmv{f} \texttt{;} }{}{}{}{\ottcom{type $T$ and field name $\ottmv{f}$}}\\ 
\ottprodline{|}{\overline{ \mathit{fd} }_{{\mathrm{1}}} \, .. \, \overline{ \mathit{fd} }_{\ottmv{n}}}{}{}{}{\ottcom{field declaration list}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some field declarations}}}

\newcommand{\ottfs}{
\ottrulehead{\overline{f}}{::=}{\ottcom{list of field identifiers}}\\ 
\ottprodline{|}{\ottmv{f_{{\mathrm{1}}}} \, .. \, \ottmv{f_{\ottmv{n}}}}{}{}{}{\ottcom{field identifier list}}\\ 
\ottprodline{|}{ \mathrm{refFields}\!\left( \ottnt{C} \right) } {\textsf{M}}{}{}{\ottcom{recursive reference type fields look-up}}\\ 
\ottprodline{|}{ \mathrm{primFields}\!\left( \ottnt{C} \right) } {\textsf{M}}{}{}{\ottcom{recursive primitive type fields look-up}}}

\newcommand{\otte}{
\ottrulehead{\ottnt{e}}{::=}{\ottcom{expression}}\\ 
\ottprodline{|}{\texttt{\upshape{null}\,\!}}{}{}{}{\ottcom{null expression}}\\ 
\ottprodline{|}{\mathcal{L}}{}{}{}{\ottcom{primitive literal}}\\ 
\ottprodline{|}{\ottnt{x}}{}{}{}{\ottcom{variable read}}\\ 
\ottprodline{|}{ \texttt{\upshape{new}\,\!} \  \ottnt{qC} \texttt{(} \texttt{)} }{}{}{}{\ottcom{object construction}}\\ 
\ottprodline{|}{ \ottnt{e} \texttt{.} \ottmv{f} }{}{}{}{\ottcom{field read}}\\ 
\ottprodline{|}{ \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f} \  := \  \ottnt{e_{{\mathrm{1}}}} }{}{}{}{\ottcom{field write}}\\ 
\ottprodline{|}{\ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \overline{e}  \texttt{)}}{}{}{}{\ottcom{method call}}\\ 
\ottprodline{|}{ \texttt{(} \ottnt{qC} \texttt{)} \  \ottnt{e} }{}{}{}{\ottcom{cast}}\\ 
\ottprodline{|}{\ottnt{e_{{\mathrm{0}}}}  \oplus  \ottnt{e_{{\mathrm{1}}}}}{}{}{}{\ottcom{primitive operation}}\\ 
\ottprodline{|}{ \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,} }{}{}{}{\ottcom{conditional}}\\ 
\ottprodline{|}{ \textit{None} } {\textsf{M}}{}{}{\ottcom{no expression defined}}}

\newcommand{\ottes}{
\ottrulehead{\overline{e}}{::=}{\ottcom{expressions}}\\ 
\ottprodline{|}{\ottnt{e_{{\mathrm{1}}}}  \ottsym{,} \, .. \, \ottsym{,}  \ottnt{e_{\ottmv{k}}}}{}{}{}{\ottcom{list of expressions}}\\ 
\ottprodline{|}{ \emptyset }{}{}{}{\ottcom{empty list}}}

\newcommand{\ottmd}{
\ottrulehead{\mathit{md}}{::=}{\ottcom{method declaration}}\\ 
\ottprodline{|}{ \ottnt{ms}  \  \texttt{\{} \  \ottnt{e} \  \texttt{\}\,} }{}{}{}{\ottcom{method signature and method body}}}

\newcommand{\ottmds}{
\ottrulehead{\overline{ \mathit{md} }}{::=}{\ottcom{method declarations}}\\ 
\ottprodline{|}{\mathit{md}}{}{}{}{\ottcom{method declaration}}\\ 
\ottprodline{|}{\overline{ \mathit{md} }_{{\mathrm{1}}} \, .. \, \overline{ \mathit{md} }_{\ottmv{n}}}{}{}{}{\ottcom{method declaration list}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some method declarations}}}

\newcommand{\ottms}{
\ottrulehead{\ottnt{ms}}{::=}{\ottcom{method signature}}\\ 
\ottprodline{|}{ T \  \ottnt{m} \texttt{(}   \overline{\mathit{mpd} }   \texttt{)} \  \ottnt{q} }{}{}{}{\ottcom{method signature definition}}\\ 
\ottprodline{|}{ \textit{None} } {\textsf{M}}{}{}{\ottcom{no method signature defined}}}

\newcommand{\ottm}{
\ottrulehead{\ottnt{m}}{::=}{\ottcom{method name}}\\ 
\ottprodline{|}{\mathit{mid}}{}{}{}{\ottcom{method identifier}}\\ 
\ottprodline{|}{ \mathrm{MName}\!\left(  \ottnt{ms}  \right) } {\textsf{M}}{}{}{\ottcom{extract method name from signature}}}

\newcommand{\ottmpds}{
\ottrulehead{\overline{\mathit{mpd} }}{::=}{\ottcom{method parameter declarations}}\\ 
\ottprodline{|}{ T \  \mathit{pid} }{}{}{}{\ottcom{type and parameter name}}\\ 
\ottprodline{|}{\overline{\mathit{mpd} }_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \overline{\mathit{mpd} }_{\ottmv{n}}}{}{}{}{\ottcom{list}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some method parameter declarations}}}

\newcommand{\ottx}{
\ottrulehead{\ottnt{x}}{::=}{\ottcom{parameter name}}\\ 
\ottprodline{|}{\mathit{pid}}{}{}{}{\ottcom{parameter identifier}}\\ 
\ottprodline{|}{\texttt{\upshape{this}\,\!}}{}{}{}{\ottcom{name of current object}}}

\newcommand{\ottsG}{
\ottrulehead{\mathit{ {^s}\!\Gamma}}{::=}{\ottcom{static environment}}\\ 
\ottprodline{|}{ \left\{  {^s}\delta  \right\} }{}{}{}{\ottcom{composition}}}

\newcommand{\ottsVEP}{
\ottrulehead{{^{s}\delta_{p} }}{::=}{\ottcom{static variable parameter environment}}\\ 
\ottprodline{|}{ \mathit{pid}   \mapsto   T }{}{}{}{\ottcom{variable $\mathit{pid}$ has type $T$}}}

\newcommand{\ottsVET}{
\ottrulehead{{^{s}\delta_{t} }}{::=}{\ottcom{static variable environment for \texttt{\upshape{this}\,\!}}}\\ 
\ottprodline{|}{ \texttt{\upshape{this}\,\!}   \mapsto   T }{}{}{}{\ottcom{variable \texttt{\upshape{this}\,\!} has type $T$}}}

\newcommand{\ottsVE}{
\ottrulehead{{^s}\delta}{::=}{\ottcom{static variable environment}}\\ 
\ottprodline{|}{{^{s}\delta_{t} }}{}{}{}{\ottcom{mapping for \texttt{\upshape{this}\,\!}}}\\ 
\ottprodline{|}{ {^{s}\delta_{t} } , \texttt{\_} }{}{}{}{\ottcom{mapping for \texttt{\upshape{this}\,\!} and some others}}\\ 
\ottprodline{|}{{^{s}\delta_{t} }  \ottsym{,}  {^{s}\delta_{p} }_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  {^{s}\delta_{p} }_{\ottmv{i}}}{}{}{}{\ottcom{mappings list}}}

\newcommand{\ottstXXfmls}{
\ottrulehead{\overline{^{s}\!fml}}{::=}{\ottcom{static formulas}}\\ 
\ottprodline{|}{\ottnt{Prg}  \textsf{=}  \ottnt{Prg'}}{}{}{}{\ottcom{program alias}}\\ 
\ottprodline{|}{\ottnt{C}  \textsf{=}  \ottnt{C'}}{}{}{}{\ottcom{class alias}}\\ 
\ottprodline{|}{T  \textsf{=}  T'}{}{}{}{\ottcom{type alias}}\\ 
\ottprodline{|}{T  \textsf{=}  T'}{}{}{}{\ottcom{option type alias}}\\ 
\ottprodline{|}{\ottnt{q}  \textsf{=}  \ottnt{q'}}{}{}{}{\ottcom{qualifier alias}}\\ 
\ottprodline{|}{\ottnt{q}  \textsf{$\not=$}  \ottnt{q'}}{}{}{}{\ottcom{qualifier not alias}}\\ 
\ottprodline{|}{\ottnt{q} \, \textsf{$\in$} \, \overline{q}}{}{}{}{\ottcom{qualifier in set of qualifiers}}\\ 
\ottprodline{|}{\ottnt{q} \, \textsf{$\notin$} \, \overline{T}}{}{}{}{\ottcom{qualifier in set of types}}\\ 
\ottprodline{|}{\ottnt{m}  \textsf{=}  \ottnt{m'}}{}{}{}{\ottcom{method name alias}}\\ 
\ottprodline{|}{\ottnt{m}  \textsf{$\not=$}  \ottnt{m'}}{}{}{}{\ottcom{method name not alias}}\\ 
\ottprodline{|}{\ottnt{ms}  \textsf{=}  \ottnt{ms'}}{}{}{}{\ottcom{method signature alias}}\\ 
\ottprodline{|}{\mathit{ {^s}\!\Gamma}  \textsf{=}  \mathit{ {^s}\!\Gamma}'}{}{}{}{\ottcom{static environment alias}}\\ 
\ottprodline{|}{\ottnt{e}  \textsf{=}  \ottnt{e'}}{}{}{}{\ottcom{expression alias}}\\ 
\ottprodline{|}{\mathit{Cls} \, \textsf{$\in$} \, \ottnt{Prg}}{}{}{}{\ottcom{class definition in program}}\\ 
\ottprodline{|}{ \texttt{\upshape{class}\,\!} \  \ottnt{C}  \ldots \in  \ottnt{Prg} }{}{}{}{\ottcom{partial class definition in program}}}

\newcommand{\ottii}{
\ottrulehead{\iota}{::=}{\ottcom{address identifier}}\\ 
\ottprodline{|}{\mathit{RAId}}{}{}{}{\ottcom{raw address identifier}}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \!\left( \texttt{\upshape{this}\,\!} \right) } {\textsf{M}}{}{}{\ottcom{currently active object look-up}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some address identifier}}}

\newcommand{\ottpp}{
\ottrulehead{{^r}\!\mathcal{L}}{::=}{\ottcom{primitive value}}\\ 
\ottprodline{|}{0}{}{}{}{\ottcom{zero value}}\\ 
\ottprodline{|}{\mathit{PrimV}}{}{}{}{\ottcom{primitive value}}\\ 
\ottprodline{|}{{^r}\!\mathcal{L}_{{\mathrm{0}}}  \oplus  {^r}\!\mathcal{L}_{{\mathrm{1}}}} {\textsf{M}}{}{}{\ottcom{binary operation}}}

\newcommand{\ottqpp}{
\ottrulehead{\rho_{q}}{::=}{\ottcom{qualified primitive value}}\\ 
\ottprodline{|}{ ( \ottnt{q} ,  {^r}\!\mathcal{L} ) }{}{}{}{\ottcom{qualified primitive value}}}

\newcommand{\ottiis}{
\ottrulehead{\overline{\iota}}{::=}{\ottcom{address identifiers}}\\ 
\ottprodline{|}{\iota_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \iota_{\ottmv{n}}}{}{}{}{\ottcom{address identifier list}}\\ 
\ottprodline{|}{ \emptyset }{}{}{}{\ottcom{empty list}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some address identifier list}}\\ 
\ottprodline{|}{ \mathrm{dom}\!\left(  \ottnt{h}  \right) } {\textsf{M}}{}{}{\ottcom{domain of heap}}}

\newcommand{\ottv}{
\ottrulehead{v}{::=}{\ottcom{value}}\\ 
\ottprodline{|}{\iota}{}{}{}{\ottcom{address identifier}}\\ 
\ottprodline{|}{\texttt{\upshape{null$_a$}\,\!}}{}{}{}{\ottcom{null value}}\\ 
\ottprodline{|}{\rho_{q}}{}{}{}{\ottcom{qualified primitive value}}\\ 
\ottprodline{|}{ \texttt{\_} } {\textsf{M}}{}{}{\ottcom{some value}}\\ 
\ottprodline{|}{ \tilde{ v } }{}{}{}{\ottcom{similarity}}\\ 
\ottprodline{|}{ \ottnt{h} \!\left( \iota \texttt{.} \ottmv{f} \right) } {\textsf{M}}{}{}{\ottcom{field value look-up}}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \!\left( \ottnt{x} \right) } {\textsf{M}}{}{}{\ottcom{argument value look-up}}\\ 
\ottprodline{|}{ \overline{\mathit{fv} } \!\left(  \ottmv{f}  \right) } {\textsf{M}}{}{}{\ottcom{field value look-up}}}

\newcommand{\ottvs}{
\ottrulehead{\overline{v}}{::=}{\ottcom{values}}\\ 
\ottprodline{|}{v_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  v_{\ottmv{n}}}{}{}{}{\ottcom{value list}}\\ 
\ottprodline{|}{ \emptyset }{}{}{}{\ottcom{empty list}}}

\newcommand{\ottfvs}{
\ottrulehead{\overline{\mathit{fv} }}{::=}{\ottcom{field values}}\\ 
\ottprodline{|}{\ottmv{f}  \mapsto  v}{}{}{}{\ottcom{field $\ottmv{f}$ has value $v$}}\\ 
\ottprodline{|}{\overline{\mathit{fv} }_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  \overline{\mathit{fv} }_{\ottmv{n}}}{}{}{}{\ottcom{field value list}}\\ 
\ottprodline{|}{ \_ } {\textsf{M}}{}{}{\ottcom{some field values}}\\ 
\ottprodline{|}{ \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{2} } {\textsf{M}}{}{}{\ottcom{look up field values in heap}}\\ 
\ottprodline{|}{ \overline{\mathit{fv} } \!\left[  \ottmv{f}   \mapsto   v  \right] } {\textsf{M}}{}{}{\ottcom{update existing field $\ottmv{f}$ to $v$}}}

\newcommand{\otto}{
\ottrulehead{\ottnt{o}}{::=}{\ottcom{object}}\\ 
\ottprodline{|}{ \left( T ,  \overline{\mathit{fv} } \right) }{}{}{}{\ottcom{type $T$ and field values $\overline{\mathit{fv} }$}}\\ 
\ottprodline{|}{ \ottnt{h} \!\left(  \iota  \right) } {\textsf{M}}{}{}{\ottcom{look up object in heap}}}

\newcommand{\otthe}{
\ottrulehead{\mathit{he}}{::=}{\ottcom{heap entry}}\\ 
\ottprodline{|}{ \left( \iota   \mapsto   \ottnt{o} \right) }{}{}{}{\ottcom{address $\iota$ maps to object $\ottnt{o}$}}}

\newcommand{\otth}{
\ottrulehead{\ottnt{h}}{::=}{\ottcom{heap}}\\ 
\ottprodline{|}{ \emptyset }{}{}{}{\ottcom{empty heap}}\\ 
\ottprodline{|}{\ottnt{h}  \oplus  \mathit{he}}{}{}{}{\ottcom{add $\mathit{he}$ to $\ottnt{h}$, overwriting existing mappings}}\\ 
\ottprodline{|}{ \tilde{ \ottnt{h} } }{}{}{}{\ottcom{similarity}}}

\newcommand{\ottrG}{
\ottrulehead{\mathit{ {^r}\!\Gamma}}{::=}{\ottcom{runtime environment}}\\ 
\ottprodline{|}{ \left\{  \ottnt{q} ;  {^{r}\delta}  \right\} }{}{}{}{\ottcom{composition}}\\ 
\ottprodline{|}{\mathit{ {^r}\!\Gamma}  \texttt{(}  \ottnt{q}  \texttt{)}} {\textsf{M}}{}{}{\ottcom{update the precision in environment $\mathit{ {^r}\!\Gamma}$}}}

\newcommand{\ottrVEP}{
\ottrulehead{{^{r}\delta_{p} }}{::=}{\ottcom{runtime variable environment parameter entry}}\\ 
\ottprodline{|}{ \mathit{pid}   \mapsto   v }{}{}{}{\ottcom{variable $\mathit{pid}$ has value $v$}}}

\newcommand{\ottrVET}{
\ottrulehead{{^{r}\delta_{t} }}{::=}{\ottcom{runtime variable environment entry for \texttt{\upshape{this}\,\!}}}\\ 
\ottprodline{|}{ \texttt{\upshape{this}\,\!}   \mapsto   \iota }{}{}{}{\ottcom{variable \texttt{\upshape{this}\,\!} has address $\iota$}}}

\newcommand{\ottrVE}{
\ottrulehead{{^{r}\delta}}{::=}{\ottcom{runtime variable environment}}\\ 
\ottprodline{|}{{^{r}\delta_{t} }}{}{}{}{\ottcom{mapping for \texttt{\upshape{this}\,\!}}}\\ 
\ottprodline{|}{ {^{r}\delta_{t} } , \texttt{\_} }{}{}{}{\ottcom{mapping for \texttt{\upshape{this}\,\!} and some others}}\\ 
\ottprodline{|}{{^{r}\delta_{t} }  \ottsym{,}  {^{r}\delta_{p} }_{{\mathrm{1}}}  \ottsym{,} \, .. \, \ottsym{,}  {^{r}\delta_{p} }_{\ottmv{k}}}{}{}{}{\ottcom{mappings list}}}

\newcommand{\ottrtXXfmls}{
\ottrulehead{\overline{^{r}\!fml}}{::=}{\ottcom{runtime formulas}}\\ 
\ottprodline{|}{\ottnt{h}  \textsf{=}  \ottnt{h'}}{}{}{}{\ottcom{heap alias}}\\ 
\ottprodline{|}{{^r}\!\mathcal{L}  \textsf{=}  {^r}\!\mathcal{L}'}{}{}{}{\ottcom{primitive value alias}}\\ 
\ottprodline{|}{{^r}\!\mathcal{L}  \textsf{$\not=$}  {^r}\!\mathcal{L}'}{}{}{}{\ottcom{primitive value not alias}}\\ 
\ottprodline{|}{{^r}\!\mathcal{L} \, \textsf{$\in$} \, \ottnt{P}}{}{}{}{\ottcom{primitive value has primitive type}}\\ 
\ottprodline{|}{v  \textsf{=}  v'}{}{}{}{\ottcom{value alias}}\\ 
\ottprodline{|}{v  \textsf{$\not=$}  v'}{}{}{}{\ottcom{value not alias}}\\ 
\ottprodline{|}{v  \textsf{=}  v'}{}{}{}{\ottcom{value alias}}\\ 
\ottprodline{|}{\ottnt{o}  \textsf{=}  \ottnt{o'}}{}{}{}{\ottcom{object alias}}\\ 
\ottprodline{|}{\iota \, \textsf{$\in$} \, \overline{\iota}}{}{}{}{\ottcom{address in addresses}}\\ 
\ottprodline{|}{\overline{\iota}  \textsf{$\not=$}  \overline{\iota}'}{}{}{}{\ottcom{addresses not aliased}}\\ 
\ottprodline{|}{\iota \, \textsf{$\notin$} \, \overline{\iota}}{}{}{}{\ottcom{address not in addresses}}\\ 
\ottprodline{|}{ \ottmv{f}  \in \mathrm{dom}\!\left(  \overline{\mathit{fv} }  \right) }{}{}{}{\ottcom{field identifier $\ottmv{f}$ contained in domain of $\overline{\mathit{fv} }$}}\\ 
\ottprodline{|}{\ottnt{x} \, \textsf{$\in$} \, \mathit{ {^r}\!\Gamma}}{}{}{}{\ottcom{parameter in runtime environment}}\\ 
\ottprodline{|}{\mathit{ {^r}\!\Gamma}  \textsf{=}  \mathit{ {^r}\!\Gamma}'}{}{}{}{\ottcom{runtime environment alias}}\\ 
\ottprodline{|}{\overline{\mathit{fv} }  \textsf{=}  \overline{\mathit{fv} }'}{}{}{}{\ottcom{fields alias}}}

\newcommand{\ottstsubxing}{
\ottrulehead{\ottnt{stsubxing}}{::=}{}\\ 
\ottprodline{|}{ \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \  \ottnt{q'} }{}{}{}{\ottcom{ordering of precision qualifiers}}\\ 
\ottprodline{|}{ \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C'} }{}{}{}{\ottcom{subclassing}}\\ 
\ottprodline{|}{ T \  \textsf{$<:$} \ \  T' }{}{}{}{\ottcom{subtyping}}\\ 
\ottprodline{|}{ \overline{T} \  \textsf{$<:$} \ \  \overline{T}' }{}{}{}{\ottcom{subtypings}}\\ 
\ottprodline{|}{ \ottnt{ms} \  \textsf{$<:$} \ \  \ottnt{ms'} }{}{}{}{\ottcom{invocations of method $\ottnt{ms}$ can safely be replaced by calls to $\ottnt{ms'}$}}}

\newcommand{\ottqcombdef}{
\ottrulehead{\ottnt{qcombdef}}{::=}{}\\ 
\ottprodline{|}{ \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \  \ottnt{q''} }{}{}{}{\ottcom{combining two precision qualifiers}}\\ 
\ottprodline{|}{ \ottnt{q} \, \rhd\,  T \ \  \textsf{=} \ \  T' }{}{}{}{\ottcom{precision qualifier - type combination}}\\ 
\ottprodline{|}{ \ottnt{q} \, \rhd\,  \overline{T} \ \  \textsf{=} \ \  \overline{T}' }{}{}{}{\ottcom{precision qualifier - types combination}}\\ 
\ottprodline{|}{ \ottnt{q} \, \rhd\,  \ottnt{ms} \ \  \textsf{=} \ \  \ottnt{ms'} }{}{}{}{\ottcom{precision qualifier - method signature combination}}}

\newcommand{\ottstXXhelpers}{
\ottrulehead{\ottnt{st\_helpers}}{::=}{}\\ 
\ottprodline{|}{ \mathrm{FType}\!\left( \ottnt{C} ,  \ottmv{f} \right)\  \textsf{=} \  T }{}{}{}{\ottcom{look up field $\ottmv{f}$ in class $\ottnt{C}$}}\\ 
\ottprodline{|}{ \mathrm{FType}\!\left( \ottnt{qC} ,  \ottmv{f} \right)\  \textsf{=} \  T }{}{}{}{\ottcom{look up field $\ottmv{f}$ in reference type $\ottnt{qC}$}}\\ 
\ottprodline{|}{ \mathrm{MSig}\!\left( \ottnt{C} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{ms} }{}{}{}{\ottcom{look up signature of method $\ottnt{m}$ in class $\ottnt{C}$}}\\ 
\ottprodline{|}{ \mathrm{MSig}\!\left( \ottnt{qC} ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms} }{}{}{}{\ottcom{look up signature of method $\ottnt{m}$ in reference type $\ottnt{qC}$}}}

\newcommand{\otttyperules}{
\ottrulehead{\ottnt{typerules}}{::=}{}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \  T }{}{}{}{\ottcom{expression typing}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \overline{e} \  \textsf{:} \  \overline{T} }{}{}{}{\ottcom{expression typings}}}

\newcommand{\ottwfstatic}{
\ottrulehead{\ottnt{wfstatic}}{::=}{}\\ 
\ottprodline{|}{ T \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed type}}\\ 
\ottprodline{|}{ \overline{T} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed types}}\\ 
\ottprodline{|}{ \mathit{Cls} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed class declaration}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  T \  \ottmv{f} \texttt{;} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed field declaration}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \overline{ \mathit{fd} } \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed field declarations}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \  \mathit{md} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed method declaration}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \  \overline{ \mathit{md} } \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed method declarations}}\\ 
\ottprodline{|}{ \ottnt{C} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} }{}{}{}{\ottcom{method overriding OK}}\\ 
\ottprodline{|}{ \ottnt{C} ,  \ottnt{C'} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} }{}{}{}{\ottcom{method overriding OK auxiliary}}\\ 
\ottprodline{|}{ \mathit{ {^s}\!\Gamma} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed static environment}}\\ 
\ottprodline{|}{ \textsf{$\vdash$} \  \ottnt{Prg} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed program}}}

\newcommand{\ottrtXXhelpers}{
\ottrulehead{\ottnt{rt\_helpers}}{::=}{}\\ 
\ottprodline{|}{ \ottnt{h}  +  \ottnt{o} \ =\ \left( \ottnt{h'} ,  \iota \right) }{}{}{}{\ottcom{add object $\ottnt{o}$ to heap $\ottnt{h}$ resulting in heap $\ottnt{h'}$ and fresh address $\iota$}}\\ 
\ottprodline{|}{ \ottnt{h} \!\left[  \iota \texttt{.} \ottmv{f} \  := \  v  \right]\  \textsf{=} \  \ottnt{h'} }{}{}{}{\ottcom{field update in heap}}\\ 
\ottprodline{|}{ \mathrm{sTrT}\!\left( \ottnt{h} ,  \iota ,  T \right)\  \textsf{=} \  T' }{}{}{}{\ottcom{convert type $T$ to its runtime equivalent $T'$}}\\ 
\ottprodline{|}{ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  v \  \textsf{:} \ \  T }{}{}{}{\ottcom{type $T$ assignable to value $v$}}\\ 
\ottprodline{|}{ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \overline{v} \  \textsf{:} \ \  \overline{T} }{}{}{}{\ottcom{types $\overline{T}$ assignable to values $\overline{v}$}}\\ 
\ottprodline{|}{ \mathrm{FType}\!\left( \ottnt{h} ,  \iota ,  \ottmv{f} \right)\  \textsf{=} \  T }{}{}{}{\ottcom{look up type of field in heap}}\\ 
\ottprodline{|}{ \mathrm{MSig}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms} }{}{}{}{\ottcom{look up method signature of method $\ottnt{m}$ at $\iota$}}\\ 
\ottprodline{|}{ \mathrm{MBody}\!\left( \ottnt{C} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{e} }{}{}{}{\ottcom{look up most-concrete body of $\ottnt{m}$, $\ottnt{q}$ in class $\ottnt{C}$ or a superclass}}\\ 
\ottprodline{|}{ \mathrm{MBody}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e} }{}{}{}{\ottcom{look up most-concrete body of method $\ottnt{m}$ at $\iota$}}\\ 
\ottprodline{|}{ \mathrm{FVsInit}\!\left( \ottnt{qC} \right)\  \textsf{=} \  \overline{\mathit{fv} } }{}{}{}{\ottcom{initialize the fields for reference type $\ottnt{qC}$}}}

\newcommand{\ottsemantics}{
\ottrulehead{\ottnt{semantics}}{::=}{}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto\  \ottnt{h'} ,  v }{}{}{}{\ottcom{big-step operational semantics}}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \overline{e} \ \leadsto\  \ottnt{h'} ,  \overline{v} }{}{}{}{\ottcom{sequential big-step operational semantics}}\\ 
\ottprodline{|}{ \textsf{$\vdash$} \  \ottnt{Prg} \ \leadsto\  \ottnt{h} ,  v }{}{}{}{\ottcom{big-step operational semantics of a program}}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto_{c}\  \ottnt{h'} ,  v }{}{}{}{\ottcom{checked big-step operational semantics}}\\ 
\ottprodline{|}{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \overline{e} \ \leadsto_{c}\  \ottnt{h'} ,  \overline{v} }{}{}{}{\ottcom{checked sequential big-step operational semantics}}}

\newcommand{\ottwfruntime}{
\ottrulehead{\ottnt{wfruntime}}{::=}{}\\ 
\ottprodline{|}{ \ottnt{h} \ \  \textsf{OK} }{}{}{}{\ottcom{well-formed heap}}\\ 
\ottprodline{|}{ \ottnt{h} ,  \mathit{ {^r}\!\Gamma} \  \textsf{:} \  \mathit{ {^s}\!\Gamma} \ \  \textsf{OK} }{}{}{}{\ottcom{runtime and static environments correspond}}}

\newcommand{\ottjudgement}{
\ottrulehead{\ottnt{judgement}}{::=}{}\\ 
\ottprodline{|}{\ottnt{stsubxing}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{qcombdef}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{st\_helpers}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{typerules}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{wfstatic}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{rt\_helpers}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{semantics}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{wfruntime}}{}{}{}{}}

\newcommand{\ottuserXXsyntax}{
\ottrulehead{\ottnt{user\_syntax}}{::=}{}\\ 
\ottprodline{|}{\ottmv{i}}{}{}{}{}\\ 
\ottprodline{|}{\ottmv{f}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{mid}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{pid}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{Cid}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{RAId}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{PrimV}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{terminals}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{formula}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{C}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{P}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{q}}{}{}{}{}\\ 
\ottprodline{|}{\overline{q}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{qC}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{qP}}{}{}{}{}\\ 
\ottprodline{|}{T}{}{}{}{}\\ 
\ottprodline{|}{\overline{T}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{Prg}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{Cls}}{}{}{}{}\\ 
\ottprodline{|}{\overline{\mathit{Cls} }}{}{}{}{}\\ 
\ottprodline{|}{\overline{ \mathit{fd} }}{}{}{}{}\\ 
\ottprodline{|}{\overline{f}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{e}}{}{}{}{}\\ 
\ottprodline{|}{\overline{e}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{md}}{}{}{}{}\\ 
\ottprodline{|}{\overline{ \mathit{md} }}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{ms}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{m}}{}{}{}{}\\ 
\ottprodline{|}{\overline{\mathit{mpd} }}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{x}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{ {^s}\!\Gamma}}{}{}{}{}\\ 
\ottprodline{|}{{^{s}\delta_{p} }}{}{}{}{}\\ 
\ottprodline{|}{{^{s}\delta_{t} }}{}{}{}{}\\ 
\ottprodline{|}{{^s}\delta}{}{}{}{}\\ 
\ottprodline{|}{\overline{^{s}\!fml}}{}{}{}{}\\ 
\ottprodline{|}{\iota}{}{}{}{}\\ 
\ottprodline{|}{{^r}\!\mathcal{L}}{}{}{}{}\\ 
\ottprodline{|}{\rho_{q}}{}{}{}{}\\ 
\ottprodline{|}{\overline{\iota}}{}{}{}{}\\ 
\ottprodline{|}{v}{}{}{}{}\\ 
\ottprodline{|}{\overline{v}}{}{}{}{}\\ 
\ottprodline{|}{\overline{\mathit{fv} }}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{o}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{he}}{}{}{}{}\\ 
\ottprodline{|}{\ottnt{h}}{}{}{}{}\\ 
\ottprodline{|}{\mathit{ {^r}\!\Gamma}}{}{}{}{}\\ 
\ottprodline{|}{{^{r}\delta_{p} }}{}{}{}{}\\ 
\ottprodline{|}{{^{r}\delta_{t} }}{}{}{}{}\\ 
\ottprodline{|}{{^{r}\delta}}{}{}{}{}\\ 
\ottprodline{|}{\overline{^{r}\!fml}}{}{}{}{}}

\newcommand{\ottgrammar}{\ottgrammartabular{
\ottterminals\ottinterrule
\ottformula\ottinterrule
\ottC\ottinterrule
\ottP\ottinterrule
\ottq\ottinterrule
\ottqs\ottinterrule
\ottqC\ottinterrule
\ottqP\ottinterrule
\ottT\ottinterrule
\ottTs\ottinterrule
\ottPrg\ottinterrule
\ottCls\ottinterrule
\ottClss\ottinterrule
\ottfds\ottinterrule
\ottfs\ottinterrule
\otte\ottinterrule
\ottes\ottinterrule
\ottmd\ottinterrule
\ottmds\ottinterrule
\ottms\ottinterrule
\ottm\ottinterrule
\ottmpds\ottinterrule
\ottx\ottinterrule
\ottsG\ottinterrule
\ottsVEP\ottinterrule
\ottsVET\ottinterrule
\ottsVE\ottinterrule
\ottstXXfmls\ottinterrule
\ottii\ottinterrule
\ottpp\ottinterrule
\ottqpp\ottinterrule
\ottiis\ottinterrule
\ottv\ottinterrule
\ottvs\ottinterrule
\ottfvs\ottinterrule
\otto\ottinterrule
\otthe\ottinterrule
\otth\ottinterrule
\ottrG\ottinterrule
\ottrVEP\ottinterrule
\ottrVET\ottinterrule
\ottrVE\ottinterrule
\ottrtXXfmls\ottinterrule
\ottstsubxing\ottinterrule
\ottqcombdef\ottinterrule
\ottstXXhelpers\ottinterrule
\otttyperules\ottinterrule
\ottwfstatic\ottinterrule
\ottrtXXhelpers\ottinterrule
\ottsemantics\ottinterrule
\ottwfruntime\ottinterrule

\ottafterlastrule
}}

% defnss
% defns stsubxing
% defn qorder
\newcommand{\ottdruleqqXXlost}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{q}  \textsf{$\not=$}   \texttt{\upshape{top}\,\!} }%
}{
 \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \   \texttt{\upshape{lost}\,\!}  }{%
{\ottdrulename{qq\_lost}}{}%
}}


\newcommand{\ottdruleqqXXtop}[1]{\ottdrule[#1]{%
}{
 \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \   \texttt{\upshape{top}\,\!}  }{%
{\ottdrulename{qq\_top}}{}%
}}


\newcommand{\ottdruleqqXXrefl}[1]{\ottdrule[#1]{%
}{
 \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \  \ottnt{q} }{%
{\ottdrulename{qq\_refl}}{}%
}}

\newcommand{\ottdefnqorder}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \  \ottnt{q'} $}{\ottcom{ordering of precision qualifiers}}
\ottusedrule{\ottdruleqqXXlost{}}
\ottusedrule{\ottdruleqqXXtop{}}
\ottusedrule{\ottdruleqqXXrefl{}}
\end{ottdefnblock}}


% defn subclassing
\newcommand{\ottdrulescXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \  \ottnt{C'} \  \texttt{\{} \   \texttt{\_}  \   \texttt{\_}  \  \texttt{\}\,}  \, \textsf{$\in$} \, \ottnt{Prg}}%
}{
 \mathit{Cid} \ \textsf{$\sqsubseteq$}\  \ottnt{C'} }{%
{\ottdrulename{sc\_def}}{}%
}}


\newcommand{\ottdrulescXXrefl}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \ottnt{C}  \ldots \in  \ottnt{Prg} }%
}{
 \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C} }{%
{\ottdrulename{sc\_refl}}{}%
}}


\newcommand{\ottdrulescXXtrans}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C_{{\mathrm{1}}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{C_{{\mathrm{1}}}} \ \textsf{$\sqsubseteq$}\  \ottnt{C'}  \hfill }%
}{
 \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C'} }{%
{\ottdrulename{sc\_trans}}{}%
}}

\newcommand{\ottdefnsubclassing}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C'} $}{\ottcom{subclassing}}
\ottusedrule{\ottdrulescXXdef{}}
\ottusedrule{\ottdrulescXXrefl{}}
\ottusedrule{\ottdrulescXXtrans{}}
\end{ottdefnblock}}


% defn subtyping
\newcommand{\ottdrulestXXrefT}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \  \ottnt{q'}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C'}  \hfill }%
}{
   \ottnt{q} \  \ottnt{C}   \  \textsf{$<:$} \ \    \ottnt{q'} \  \ottnt{C'}   }{%
{\ottdrulename{st\_refT}}{}%
}}


\newcommand{\ottdrulestXXprimTOne}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{q} \  \textsf{$<:_{\mathrm q}$} \  \ottnt{q'} }%
}{
   \ottnt{q} \  \ottnt{P}   \  \textsf{$<:$} \ \    \ottnt{q'} \  \ottnt{P}   }{%
{\ottdrulename{st\_primT1}}{}%
}}


\newcommand{\ottdrulestXXprimTTwo}[1]{\ottdrule[#1]{%
}{
    \texttt{\upshape{precise}\,\!}  \  \ottnt{P}   \  \textsf{$<:$} \ \     \texttt{\upshape{approx}\,\!}  \  \ottnt{P}   }{%
{\ottdrulename{st\_primT2}}{}%
}}

\newcommand{\ottdefnsubtyping}[1]{\begin{ottdefnblock}[#1]{$ T \  \textsf{$<:$} \ \  T' $}{\ottcom{subtyping}}
\ottusedrule{\ottdrulestXXrefT{}}
\ottusedrule{\ottdrulestXXprimTOne{}}
\ottusedrule{\ottdrulestXXprimTTwo{}}
\end{ottdefnblock}}


% defn subtypings
\newcommand{\ottdrulestsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ T_{\ottmv{i}} \  \textsf{$<:$} \ \  T'_{\ottmv{i}} }{\ottmv{i}}}%
}{
 \ottcomp{T_{\ottmv{i}}}{\ottmv{i}} \  \textsf{$<:$} \ \  \ottcomp{T'_{\ottmv{i}}}{\ottmv{i}} }{%
{\ottdrulename{sts\_def}}{}%
}}

\newcommand{\ottdefnsubtypings}[1]{\begin{ottdefnblock}[#1]{$ \overline{T} \  \textsf{$<:$} \ \  \overline{T}' $}{\ottcom{subtypings}}
\ottusedrule{\ottdrulestsXXdef{}}
\end{ottdefnblock}}


% defn methodsubtyping
\newcommand{\ottdrulemstXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   T' \  \textsf{$<:$} \ \  T   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottcomp{T_{\ottmv{k}}}{\ottmv{k}} \  \textsf{$<:$} \ \  \ottcomp{T'_{\ottmv{k}}}{\ottmv{k}}  \hfill }%
}{
  T \  \ottnt{m} \texttt{(}   \ottcomp{ T_{\ottmv{k}} \  \mathit{pid} }{\ottmv{k}}   \texttt{)} \   \texttt{\upshape{precise}\,\!}   \  \textsf{$<:$} \ \   T' \  \ottnt{m} \texttt{(}   \ottcomp{ T'_{\ottmv{k}} \  \mathit{pid} }{\ottmv{k}}   \texttt{)} \   \texttt{\upshape{approx}\,\!}   }{%
{\ottdrulename{mst\_def}}{}%
}}

\newcommand{\ottdefnmethodsubtyping}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{ms} \  \textsf{$<:$} \ \  \ottnt{ms'} $}{\ottcom{invocations of method $\ottnt{ms}$ can safely be replaced by calls to $\ottnt{ms'}$}}
\ottusedrule{\ottdrulemstXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsstsubxing}{
\ottdefnqorder{}
\ottdefnsubclassing{}
\ottdefnsubtyping{}
\ottdefnsubtypings{}
\ottdefnmethodsubtyping{}}


% defns qcombdef
% defn qcombqrules
\newcommand{\ottdruleqcqXXcontext}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{q'}  \textsf{=}   \texttt{\upshape{context}\,\!}  \ \  \textsf{$\wedge$} \ \   ( \ottnt{q} \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{approx}\,\!}   \ottsym{,}   \texttt{\upshape{precise}\,\!}   \ottsym{,}   \texttt{\upshape{context}\,\!}   \right\}  )  }%
}{
 \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \  \ottnt{q} }{%
{\ottdrulename{qcq\_context}}{}%
}}


\newcommand{\ottdruleqcqXXlost}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{q'}  \textsf{=}   \texttt{\upshape{context}\,\!}  \ \  \textsf{$\wedge$} \ \   ( \ottnt{q} \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{top}\,\!}   \ottsym{,}   \texttt{\upshape{lost}\,\!}   \right\}  )  }%
}{
 \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \   \texttt{\upshape{lost}\,\!}  }{%
{\ottdrulename{qcq\_lost}}{}%
}}


\newcommand{\ottdruleqcqXXfixed}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{q'}  \textsf{$\not=$}   \texttt{\upshape{context}\,\!} }%
}{
 \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \  \ottnt{q'} }{%
{\ottdrulename{qcq\_fixed}}{}%
}}

\newcommand{\ottdefnqcombqrules}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \  \ottnt{q''} $}{\ottcom{combining two precision qualifiers}}
\ottusedrule{\ottdruleqcqXXcontext{}}
\ottusedrule{\ottdruleqcqXXlost{}}
\ottusedrule{\ottdruleqcqXXfixed{}}
\end{ottdefnblock}}


% defn qcombtrules
\newcommand{\ottdruleqctXXrefT}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \  \ottnt{q''} }%
}{
 \ottnt{q} \, \rhd\,    \ottnt{q'} \  \ottnt{C}   \ \  \textsf{=} \ \    \ottnt{q''} \  \ottnt{C}   }{%
{\ottdrulename{qct\_refT}}{}%
}}


\newcommand{\ottdruleqctXXprimT}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{q} \, \rhd\,  \ottnt{q'} \ \  \textsf{=} \ \  \ottnt{q''} }%
}{
 \ottnt{q} \, \rhd\,    \ottnt{q'} \  \ottnt{P}   \ \  \textsf{=} \ \    \ottnt{q''} \  \ottnt{P}   }{%
{\ottdrulename{qct\_primT}}{}%
}}

\newcommand{\ottdefnqcombtrules}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{q} \, \rhd\,  T \ \  \textsf{=} \ \  T' $}{\ottcom{precision qualifier - type combination}}
\ottusedrule{\ottdruleqctXXrefT{}}
\ottusedrule{\ottdruleqctXXprimT{}}
\end{ottdefnblock}}


% defn qcombtsrules
\newcommand{\ottdruleqctsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ \ottnt{q} \, \rhd\,  T_{\ottmv{k}} \ \  \textsf{=} \ \  T'_{\ottmv{k}} }{\ottmv{k}}}%
}{
 \ottnt{q} \, \rhd\,  \ottcomp{T_{\ottmv{k}}}{\ottmv{k}} \ \  \textsf{=} \ \  \ottcomp{T'_{\ottmv{k}}}{\ottmv{k}} }{%
{\ottdrulename{qcts\_def}}{}%
}}

\newcommand{\ottdefnqcombtsrules}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{q} \, \rhd\,  \overline{T} \ \  \textsf{=} \ \  \overline{T}' $}{\ottcom{precision qualifier - types combination}}
\ottusedrule{\ottdruleqctsXXdef{}}
\end{ottdefnblock}}


% defn qcombmsrules
\newcommand{\ottdruleqcmsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{q} \, \rhd\,  T \ \  \textsf{=} \ \  T'   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{q} \, \rhd\,  \ottcomp{T_{\ottmv{k}}}{\ottmv{k}} \ \  \textsf{=} \ \  \ottcomp{T'_{\ottmv{k}}}{\ottmv{k}}  \hfill }%
}{
 \ottnt{q} \, \rhd\,   T \  \ottnt{m} \texttt{(}   \ottcomp{ T_{\ottmv{k}} \  \mathit{pid} }{\ottmv{k}}   \texttt{)} \  \ottnt{q'}  \ \  \textsf{=} \ \   T' \  \ottnt{m} \texttt{(}   \ottcomp{ T'_{\ottmv{k}} \  \mathit{pid} }{\ottmv{k}}   \texttt{)} \  \ottnt{q'}  }{%
{\ottdrulename{qcms\_def}}{}%
}}

\newcommand{\ottdefnqcombmsrules}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{q} \, \rhd\,  \ottnt{ms} \ \  \textsf{=} \ \  \ottnt{ms'} $}{\ottcom{precision qualifier - method signature combination}}
\ottusedrule{\ottdruleqcmsXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsqcombdef}{
\ottdefnqcombqrules{}
\ottdefnqcombtrules{}
\ottdefnqcombtsrules{}
\ottdefnqcombmsrules{}}


% defns st_helpers
% defn sftypec
\newcommand{\ottdrulesftcXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \   \texttt{\_}  \  \texttt{\{} \   \texttt{\_}  \,  T \  \ottmv{f} \texttt{;}  \,  \texttt{\_}  \   \texttt{\_}  \  \texttt{\}\,}  \, \textsf{$\in$} \, \ottnt{Prg}}%
}{
 \mathrm{FType}\!\left( \mathit{Cid} ,  \ottmv{f} \right)\  \textsf{=} \  T }{%
{\ottdrulename{sftc\_def}}{}%
}}

\newcommand{\ottdefnsftypec}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{FType}\!\left( \ottnt{C} ,  \ottmv{f} \right)\  \textsf{=} \  T $}{\ottcom{look up field $\ottmv{f}$ in class $\ottnt{C}$}}
\ottusedrule{\ottdrulesftcXXdef{}}
\end{ottdefnblock}}


% defn sftypet
\newcommand{\ottdrulesfttXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathrm{FType}\!\left( \ottnt{C} ,  \ottmv{f} \right)\  \textsf{=} \  T_{{\mathrm{1}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{q} \, \rhd\,  T_{{\mathrm{1}}} \ \  \textsf{=} \ \  T  \hfill }%
}{
 \mathrm{FType}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottmv{f} \right)\  \textsf{=} \  T }{%
{\ottdrulename{sftt\_def}}{}%
}}

\newcommand{\ottdefnsftypet}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{FType}\!\left( \ottnt{qC} ,  \ottmv{f} \right)\  \textsf{=} \  T $}{\ottcom{look up field $\ottmv{f}$ in reference type $\ottnt{qC}$}}
\ottusedrule{\ottdrulesfttXXdef{}}
\end{ottdefnblock}}


% defn smsigc
\newcommand{\ottdrulesmscXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \   \texttt{\_}  \  \texttt{\{} \   \texttt{\_}  \   \texttt{\_}  \,  \ottnt{ms}  \  \texttt{\{} \  \ottnt{e} \  \texttt{\}\,}  \,  \texttt{\_}  \  \texttt{\}\,}  \, \textsf{$\in$} \, \ottnt{Prg}}%
\ottpremise{  \mathrm{MName}\!\left(  \ottnt{ms}  \right)   \textsf{=}  \ottnt{m} \ \  \textsf{$\wedge$} \ \   \mathrm{MQual}\!\left(  \ottnt{ms}  \right)   \textsf{=}  \ottnt{q} }%
}{
 \mathrm{MSig}\!\left( \mathit{Cid} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{ms} }{%
{\ottdrulename{smsc\_def}}{}%
}}

\newcommand{\ottdefnsmsigc}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{MSig}\!\left( \ottnt{C} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{ms} $}{\ottcom{look up signature of method $\ottnt{m}$ in class $\ottnt{C}$}}
\ottusedrule{\ottdrulesmscXXdef{}}
\end{ottdefnblock}}


% defn smsigt
\newcommand{\ottdrulesmstXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathrm{MSig}\!\left( \ottnt{C} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{ms}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{q} \, \rhd\,  \ottnt{ms} \ \  \textsf{=} \ \  \ottnt{ms'}  \hfill }%
}{
 \mathrm{MSig}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms'} }{%
{\ottdrulename{smst\_def}}{}%
}}

\newcommand{\ottdefnsmsigt}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{MSig}\!\left( \ottnt{qC} ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms} $}{\ottcom{look up signature of method $\ottnt{m}$ in reference type $\ottnt{qC}$}}
\ottusedrule{\ottdrulesmstXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsstXXhelpers}{
\ottdefnsftypec{}
\ottdefnsftypet{}
\ottdefnsmsigc{}
\ottdefnsmsigt{}}


% defns typerules
% defn typerules
\newcommand{\ottdruletrXXsubsum}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \  T_{{\mathrm{1}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   T_{{\mathrm{1}}} \  \textsf{$<:$} \ \  T  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \  T }{%
{\ottdrulename{tr\_subsum}}{}%
}}


\newcommand{\ottdruletrXXnull}[1]{\ottdrule[#1]{%
\ottpremise{  \ottnt{qC}  \ \  \textsf{OK} }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \texttt{\upshape{null}\,\!} \  \textsf{:} \   \ottnt{qC}  }{%
{\ottdrulename{tr\_null}}{}%
}}


\newcommand{\ottdruletrXXliteral}[1]{\ottdrule[#1]{%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \mathcal{L} \  \textsf{:} \     \texttt{\upshape{precise}\,\!}  \  \ottnt{P}   }{%
{\ottdrulename{tr\_literal}}{}%
}}


\newcommand{\ottdruletrXXvar}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^s}\!\Gamma} \!\left( \ottnt{x} \right)   \textsf{=}  T}%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{x} \  \textsf{:} \  T }{%
{\ottdrulename{tr\_var}}{}%
}}


\newcommand{\ottdruletrXXnew}[1]{\ottdrule[#1]{%
\ottpremise{   \ottnt{q} \  \ottnt{C}   \ \  \textsf{OK} }%
\ottpremise{\ottnt{q} \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{precise}\,\!}   \ottsym{,}   \texttt{\upshape{approx}\,\!}   \ottsym{,}   \texttt{\upshape{context}\,\!}   \right\} }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \   \texttt{\upshape{new}\,\!} \   \ottnt{q} \  \ottnt{C}  \texttt{(} \texttt{)}  \  \textsf{:} \  T }{%
{\ottdrulename{tr\_new}}{}%
}}


\newcommand{\ottdruletrXXread}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \    \ottnt{q} \  \ottnt{C}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{FType}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottmv{f} \right)\  \textsf{=} \  T  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f}  \  \textsf{:} \  T }{%
{\ottdrulename{tr\_read}}{}%
}}


\newcommand{\ottdruletrXXwrite}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \    \ottnt{q} \  \ottnt{C}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{FType}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottmv{f} \right)\  \textsf{=} \  T  \hfill }%
\ottpremise{ \hfill   \texttt{\upshape{lost}\,\!}  \, \textsf{$\notin$} \, T  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{1}}}} \  \textsf{:} \  T  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f} \  := \  \ottnt{e_{{\mathrm{1}}}}  \  \textsf{:} \  T }{%
{\ottdrulename{tr\_write}}{}%
}}


\newcommand{\ottdruletrXXcallOne}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \    \ottnt{q} \  \ottnt{C}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  \ottnt{q} \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{precise}\,\!}   \ottsym{,}   \texttt{\upshape{context}\,\!}   \ottsym{,}   \texttt{\upshape{top}\,\!}   \right\}  \hfill }%
\ottpremise{ \mathrm{MSig}\!\left(   \texttt{\upshape{precise}\,\!}  \  \ottnt{C}  ,  \ottnt{m} \right)\  \textsf{=} \   T \  \ottnt{m} \texttt{(}   \ottcomp{ T_{\ottmv{i}} \  \mathit{pid} }{\ottmv{i}}   \texttt{)} \   \texttt{\upshape{precise}\,\!}   }%
\ottpremise{ \hfill   \texttt{\upshape{lost}\,\!}  \, \textsf{$\notin$} \, \ottcomp{T_{\ottmv{i}}}{\ottmv{i}}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \  \textsf{:} \  \ottcomp{T_{\ottmv{i}}}{\ottmv{i}}  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}}  \texttt{)} \  \textsf{:} \  T }{%
{\ottdrulename{tr\_call1}}{}%
}}


\newcommand{\ottdruletrXXcallTwo}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \     \texttt{\upshape{approx}\,\!}  \  \ottnt{C}   }%
\ottpremise{ \mathrm{MSig}\!\left(   \texttt{\upshape{approx}\,\!}  \  \ottnt{C}  ,  \ottnt{m} \right)\  \textsf{=} \   T \  \ottnt{m} \texttt{(}   \ottcomp{ T_{\ottmv{i}} \  \mathit{pid} }{\ottmv{i}}   \texttt{)} \   \texttt{\upshape{approx}\,\!}   }%
\ottpremise{ \hfill   \texttt{\upshape{lost}\,\!}  \, \textsf{$\notin$} \, \ottcomp{T_{\ottmv{i}}}{\ottmv{i}}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \  \textsf{:} \  \ottcomp{T_{\ottmv{i}}}{\ottmv{i}}  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}}  \texttt{)} \  \textsf{:} \  T }{%
{\ottdrulename{tr\_call2}}{}%
}}


\newcommand{\ottdruletrXXcallThree}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \     \texttt{\upshape{approx}\,\!}  \  \ottnt{C}   }%
\ottpremise{ \mathrm{MSig}\!\left(   \texttt{\upshape{approx}\,\!}  \  \ottnt{C}  ,  \ottnt{m} \right)\  \textsf{=} \   \textit{None}  }%
\ottpremise{ \mathrm{MSig}\!\left(   \texttt{\upshape{precise}\,\!}  \  \ottnt{C}  ,  \ottnt{m} \right)\  \textsf{=} \   T \  \ottnt{m} \texttt{(}   \ottcomp{ T_{\ottmv{i}} \  \mathit{pid} }{\ottmv{i}}   \texttt{)} \   \texttt{\upshape{precise}\,\!}   }%
\ottpremise{ \hfill   \texttt{\upshape{lost}\,\!}  \, \textsf{$\notin$} \, \ottcomp{T_{\ottmv{i}}}{\ottmv{i}}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \  \textsf{:} \  \ottcomp{T_{\ottmv{i}}}{\ottmv{i}}  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}}  \texttt{)} \  \textsf{:} \  T }{%
{\ottdrulename{tr\_call3}}{}%
}}


\newcommand{\ottdruletrXXcast}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \   \texttt{\_}    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill     \ottnt{q} \  \ottnt{C}   \ \  \textsf{OK}  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \   \texttt{(}  \ottnt{q} \  \ottnt{C}  \texttt{)} \  \ottnt{e}  \  \textsf{:} \  T }{%
{\ottdrulename{tr\_cast}}{}%
}}


\newcommand{\ottdruletrXXprimop}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \    \ottnt{q} \  \ottnt{P}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{1}}}} \  \textsf{:} \    \ottnt{q} \  \ottnt{P}    \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}}  \oplus  \ottnt{e_{{\mathrm{1}}}} \  \textsf{:} \    \ottnt{q} \  \ottnt{P}   }{%
{\ottdrulename{tr\_primop}}{}%
}}


\newcommand{\ottdruletrXXcond}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{0}}}} \  \textsf{:} \     \texttt{\upshape{precise}\,\!}  \  \ottnt{P}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{1}}}} \  \textsf{:} \  T  \hfill   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{{\mathrm{2}}}} \  \textsf{:} \  T  \hfill }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \  \textsf{:} \  T }{%
{\ottdrulename{tr\_cond}}{}%
}}

\newcommand{\ottdefntyperules}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \  T $}{\ottcom{expression typing}}
\ottusedrule{\ottdruletrXXsubsum{}}
\ottusedrule{\ottdruletrXXnull{}}
\ottusedrule{\ottdruletrXXliteral{}}
\ottusedrule{\ottdruletrXXvar{}}
\ottusedrule{\ottdruletrXXnew{}}
\ottusedrule{\ottdruletrXXread{}}
\ottusedrule{\ottdruletrXXwrite{}}
\ottusedrule{\ottdruletrXXcallOne{}}
\ottusedrule{\ottdruletrXXcallTwo{}}
\ottusedrule{\ottdruletrXXcallThree{}}
\ottusedrule{\ottdruletrXXcast{}}
\ottusedrule{\ottdruletrXXprimop{}}
\ottusedrule{\ottdruletrXXcond{}}
\end{ottdefnblock}}


% defn typerulesmulti
\newcommand{\ottdruletrmXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{e_{\ottmv{k}}} \  \textsf{:} \  T_{\ottmv{k}} }{\ottmv{k}}}%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottcomp{\ottnt{e_{\ottmv{k}}}}{\ottmv{k}} \  \textsf{:} \  \ottcomp{T_{\ottmv{k}}}{\ottmv{k}} }{%
{\ottdrulename{trm\_def}}{}%
}}

\newcommand{\ottdefntyperulesmulti}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \overline{e} \  \textsf{:} \  \overline{T} $}{\ottcom{expression typings}}
\ottusedrule{\ottdruletrmXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnstyperules}{
\ottdefntyperules{}
\ottdefntyperulesmulti{}}


% defns wfstatic
% defn wftype
\newcommand{\ottdrulewftXXrefT}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \ottnt{C}  \ldots \in  \ottnt{Prg} }%
}{
   \ottnt{q} \  \ottnt{C}   \ \  \textsf{OK} }{%
{\ottdrulename{wft\_refT}}{}%
}}


\newcommand{\ottdrulewftXXprimT}[1]{\ottdrule[#1]{%
}{
   \ottnt{q} \  \ottnt{P}   \ \  \textsf{OK} }{%
{\ottdrulename{wft\_primT}}{}%
}}

\newcommand{\ottdefnwftype}[1]{\begin{ottdefnblock}[#1]{$ T \ \  \textsf{OK} $}{\ottcom{well-formed type}}
\ottusedrule{\ottdrulewftXXrefT{}}
\ottusedrule{\ottdrulewftXXprimT{}}
\end{ottdefnblock}}


% defn wftypes
\newcommand{\ottdrulewftsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ T_{\ottmv{k}} \ \  \textsf{OK} }{\ottmv{k}}}%
}{
 \ottcomp{T_{\ottmv{k}}}{\ottmv{k}} \ \  \textsf{OK} }{%
{\ottdrulename{wfts\_def}}{}%
}}

\newcommand{\ottdefnwftypes}[1]{\begin{ottdefnblock}[#1]{$ \overline{T} \ \  \textsf{OK} $}{\ottcom{well-formed types}}
\ottusedrule{\ottdrulewftsXXdef{}}
\end{ottdefnblock}}


% defn wfclass
\newcommand{\ottdrulewfcXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\mathit{ {^s}\!\Gamma}  \textsf{=}   \left\{   \texttt{\upshape{this}\,\!}   \mapsto      \texttt{\upshape{context}\,\!}  \  \mathit{Cid}     \right\} }%
\ottpremise{ \hfill   \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \overline{ \mathit{fd} } \ \  \textsf{OK}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} ,  \mathit{Cid} \  \textsf{$\vdash$} \  \overline{ \mathit{md} } \ \  \textsf{OK}  \hfill }%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \ottnt{C}  \ldots \in  \ottnt{Prg} }%
}{
  \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \  \ottnt{C} \  \texttt{\{} \  \overline{ \mathit{fd} } \  \overline{ \mathit{md} } \  \texttt{\}\,}  \ \  \textsf{OK} }{%
{\ottdrulename{wfc\_def}}{}%
}}


\newcommand{\ottdrulewfcXXobject}[1]{\ottdrule[#1]{%
}{
  \texttt{\upshape{class}\,\!} \  \texttt{\upshape{Object}\,\!} \  \texttt{\{} \texttt{\}\,}  \ \  \textsf{OK} }{%
{\ottdrulename{wfc\_object}}{}%
}}

\newcommand{\ottdefnwfclass}[1]{\begin{ottdefnblock}[#1]{$ \mathit{Cls} \ \  \textsf{OK} $}{\ottcom{well-formed class declaration}}
\ottusedrule{\ottdrulewfcXXdef{}}
\ottusedrule{\ottdrulewfcXXobject{}}
\end{ottdefnblock}}


% defn wffd
\newcommand{\ottdrulewffdXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ T \ \  \textsf{OK} }%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  T \  \ottmv{f} \texttt{;} \ \  \textsf{OK} }{%
{\ottdrulename{wffd\_def}}{}%
}}

\newcommand{\ottdefnwffd}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  T \  \ottmv{f} \texttt{;} \ \  \textsf{OK} $}{\ottcom{well-formed field declaration}}
\ottusedrule{\ottdrulewffdXXdef{}}
\end{ottdefnblock}}


% defn wffds
\newcommand{\ottdrulewffdsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  T_{\ottmv{i}} \  \ottmv{f_{\ottmv{i}}} \texttt{;} \ \  \textsf{OK} }{\ottmv{i}}}%
}{
 \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \ottcomp{ T_{\ottmv{i}} \  \ottmv{f_{\ottmv{i}}} \texttt{;} }{\ottmv{i}} \ \  \textsf{OK} }{%
{\ottdrulename{wffds\_def}}{}%
}}

\newcommand{\ottdefnwffds}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} \  \textsf{$\vdash$} \  \overline{ \mathit{fd} } \ \  \textsf{OK} $}{\ottcom{well-formed field declarations}}
\ottusedrule{\ottdrulewffdsXXdef{}}
\end{ottdefnblock}}


% defn wfmd
\newcommand{\ottdrulewfmdXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\mathit{ {^s}\!\Gamma}  \textsf{=}   \left\{   \texttt{\upshape{this}\,\!}   \mapsto      \texttt{\upshape{context}\,\!}  \  \ottnt{C}     \right\} }%
\ottpremise{\mathit{ {^s}\!\Gamma}'  \textsf{=}   \left\{   \texttt{\upshape{this}\,\!}   \mapsto      \texttt{\upshape{context}\,\!}  \  \ottnt{C}     \ottsym{,} \, \ottcomp{ \mathit{pid}   \mapsto   T_{\ottmv{i}} }{\ottmv{i}}  \right\} }%
\ottpremise{ \hfill   \hfill   T  \ottsym{,} \, \ottcomp{T_{\ottmv{i}}}{\ottmv{i}} \ \  \textsf{OK}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma}' \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \  T  \hfill   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{C} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK}  \hfill }%
\ottpremise{\ottnt{q} \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{precise}\,\!}   \ottsym{,}   \texttt{\upshape{approx}\,\!}   \right\} }%
}{
 \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \    T \  \ottnt{m} \texttt{(}   \ottcomp{ T_{\ottmv{i}} \  \mathit{pid} }{\ottmv{i}}   \texttt{)} \  \ottnt{q}   \  \texttt{\{} \  \ottnt{e} \  \texttt{\}\,}  \ \  \textsf{OK} }{%
{\ottdrulename{wfmd\_def}}{}%
}}

\newcommand{\ottdefnwfmd}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \  \mathit{md} \ \  \textsf{OK} $}{\ottcom{well-formed method declaration}}
\ottusedrule{\ottdrulewfmdXXdef{}}
\end{ottdefnblock}}


% defn wfmds
\newcommand{\ottdrulewfmdsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \  \mathit{md}_{\ottmv{k}} \ \  \textsf{OK} }{\ottmv{k}}}%
}{
 \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \  \ottcomp{\mathit{md}_{\ottmv{k}}}{\ottmv{k}} \ \  \textsf{OK} }{%
{\ottdrulename{wfmds\_def}}{}%
}}

\newcommand{\ottdefnwfmds}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} ,  \ottnt{C} \  \textsf{$\vdash$} \  \overline{ \mathit{md} } \ \  \textsf{OK} $}{\ottcom{well-formed method declarations}}
\ottusedrule{\ottdrulewfmdsXXdef{}}
\end{ottdefnblock}}


% defn override
\newcommand{\ottdruleovrXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \ottnt{C} \ \textsf{$\sqsubseteq$}\  \ottnt{C'}   \textsf{$\implies$}   \ottnt{C} ,  \ottnt{C'} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} }%
}{
 \ottnt{C} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} }{%
{\ottdrulename{ovr\_def}}{}%
}}

\newcommand{\ottdefnoverride}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{C} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} $}{\ottcom{method overriding OK}}
\ottusedrule{\ottdruleovrXXdef{}}
\end{ottdefnblock}}


% defn overrideaux
\newcommand{\ottdruleovraXXdef}[1]{\ottdrule[#1]{%
\ottpremise{  \mathrm{MSig}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{precise}\,\!}  \right)\  \textsf{=} \  \ottnt{ms_{{\mathrm{0}}}}  \ \  \textsf{$\wedge$} \ \    \mathrm{MSig}\!\left( \ottnt{C'} ,  \ottnt{m} ,   \texttt{\upshape{precise}\,\!}  \right)\  \textsf{=} \  \ottnt{ms'_{{\mathrm{0}}}}  \ \  \textsf{$\wedge$} \ \   (  \ottnt{ms'_{{\mathrm{0}}}}  \textsf{=}   \textit{None}  \ \  \textsf{$\vee$} \ \  \ottnt{ms_{{\mathrm{0}}}}  \textsf{=}  \ottnt{ms'_{{\mathrm{0}}}}  )   }%
\ottpremise{  \mathrm{MSig}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{approx}\,\!}  \right)\  \textsf{=} \  \ottnt{ms_{{\mathrm{1}}}}  \ \  \textsf{$\wedge$} \ \    \mathrm{MSig}\!\left( \ottnt{C'} ,  \ottnt{m} ,   \texttt{\upshape{approx}\,\!}  \right)\  \textsf{=} \  \ottnt{ms'_{{\mathrm{1}}}}  \ \  \textsf{$\wedge$} \ \   (  \ottnt{ms'_{{\mathrm{1}}}}  \textsf{=}   \textit{None}  \ \  \textsf{$\vee$} \ \  \ottnt{ms_{{\mathrm{1}}}}  \textsf{=}  \ottnt{ms'_{{\mathrm{1}}}}  )   }%
\ottpremise{  \mathrm{MSig}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{precise}\,\!}  \right)\  \textsf{=} \  \ottnt{ms_{{\mathrm{2}}}}  \ \  \textsf{$\wedge$} \ \    \mathrm{MSig}\!\left( \ottnt{C'} ,  \ottnt{m} ,   \texttt{\upshape{approx}\,\!}  \right)\  \textsf{=} \  \ottnt{ms'_{{\mathrm{2}}}}  \ \  \textsf{$\wedge$} \ \   (  \ottnt{ms'_{{\mathrm{2}}}}  \textsf{=}   \textit{None}  \ \  \textsf{$\vee$} \ \   \ottnt{ms_{{\mathrm{2}}}} \  \textsf{$<:$} \ \  \ottnt{ms'_{{\mathrm{2}}}}   )   }%
}{
 \ottnt{C} ,  \ottnt{C'} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} }{%
{\ottdrulename{ovra\_def}}{}%
}}

\newcommand{\ottdefnoverrideaux}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{C} ,  \ottnt{C'} \  \textsf{$\vdash$} \  \ottnt{m} \ \  \textsf{OK} $}{\ottcom{method overriding OK auxiliary}}
\ottusedrule{\ottdruleovraXXdef{}}
\end{ottdefnblock}}


% defn swfenv
\newcommand{\ottdruleswfeXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\mathit{ {^s}\!\Gamma}  \textsf{=}   \left\{   \texttt{\upshape{this}\,\!}   \mapsto     \ottnt{q} \  \ottnt{C}     \ottsym{,} \, \ottcomp{ \mathit{pid}   \mapsto   T_{\ottmv{i}} }{\ottmv{i}}  \right\} }%
\ottpremise{   \ottnt{q} \  \ottnt{C}    \ottsym{,} \, \ottcomp{T_{\ottmv{i}}}{\ottmv{i}} \ \  \textsf{OK} }%
}{
 \mathit{ {^s}\!\Gamma} \ \  \textsf{OK} }{%
{\ottdrulename{swfe\_def}}{}%
}}

\newcommand{\ottdefnswfenv}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^s}\!\Gamma} \ \  \textsf{OK} $}{\ottcom{well-formed static environment}}
\ottusedrule{\ottdruleswfeXXdef{}}
\end{ottdefnblock}}


% defn wfprg
\newcommand{\ottdrulewfpXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{Prg}  \textsf{=}   \ottcomp{\mathit{Cls}_{\ottmv{i}}}{\ottmv{i}} ,\  \ottnt{C} ,\  \ottnt{e} }%
\ottpremise{ \hfill  \ottcomp{ \mathit{Cls}_{\ottmv{i}} \ \  \textsf{OK} }{\ottmv{i}}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill      \texttt{\upshape{context}\,\!}  \  \ottnt{C}   \ \  \textsf{OK}  \hfill }%
\ottpremise{  \left\{   \texttt{\upshape{this}\,\!}   \mapsto      \texttt{\upshape{context}\,\!}  \  \ottnt{C}     \right\}  \  \textsf{$\vdash$} \  \ottnt{e} \  \textsf{:} \   \texttt{\_}  }%
\ottpremise{ \forall  \ottnt{C'} ,  \ottnt{C''} .\   (  (   \ottnt{C'} \ \textsf{$\sqsubseteq$}\  \ottnt{C''}  \ \  \textsf{$\wedge$} \ \   \ottnt{C''} \ \textsf{$\sqsubseteq$}\  \ottnt{C'}   )   \textsf{$\implies$}  \ottnt{C'}  \textsf{=}  \ottnt{C''} )  }%
}{
 \textsf{$\vdash$} \  \ottnt{Prg} \ \  \textsf{OK} }{%
{\ottdrulename{wfp\_def}}{}%
}}

\newcommand{\ottdefnwfprg}[1]{\begin{ottdefnblock}[#1]{$ \textsf{$\vdash$} \  \ottnt{Prg} \ \  \textsf{OK} $}{\ottcom{well-formed program}}
\ottusedrule{\ottdrulewfpXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnswfstatic}{
\ottdefnwftype{}
\ottdefnwftypes{}
\ottdefnwfclass{}
\ottdefnwffd{}
\ottdefnwffds{}
\ottdefnwfmd{}
\ottdefnwfmds{}
\ottdefnoverride{}
\ottdefnoverrideaux{}
\ottdefnswfenv{}
\ottdefnwfprg{}}


% defns rt_helpers
% defn creation
\newcommand{\ottdrulehnewXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill  \iota \, \textsf{$\notin$} \,  \mathrm{dom}\!\left(  \ottnt{h}  \right)   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  \ottnt{h'}  \textsf{=}  \ottnt{h}  \oplus   \left( \iota   \mapsto   \ottnt{o} \right)  \hfill }%
}{
 \ottnt{h}  +  \ottnt{o} \ =\ \left( \ottnt{h'} ,  \iota \right) }{%
{\ottdrulename{hnew\_def}}{}%
}}

\newcommand{\ottdefncreation}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{h}  +  \ottnt{o} \ =\ \left( \ottnt{h'} ,  \iota \right) $}{\ottcom{add object $\ottnt{o}$ to heap $\ottnt{h}$ resulting in heap $\ottnt{h'}$ and fresh address $\iota$}}
\ottusedrule{\ottdrulehnewXXdef{}}
\end{ottdefnblock}}


% defn update
\newcommand{\ottdrulehupXXrefT}[1]{\ottdrule[#1]{%
\ottpremise{ v  \textsf{=}  \texttt{\upshape{null$_a$}\,\!} \ \  \textsf{$\vee$} \ \   (  v  \textsf{=}  \iota' \ \  \textsf{$\wedge$} \ \  \iota' \, \textsf{$\in$} \,  \mathrm{dom}\!\left(  \ottnt{h}  \right)   )  }%
\ottpremise{ \hfill   \ottnt{h} \!\left(  \iota  \right)   \textsf{=}   \left( T ,  \overline{\mathit{fv} } \right)   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \hfill   \ottmv{f}  \in \mathrm{dom}\!\left(  \overline{\mathit{fv} }  \right)   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  \overline{\mathit{fv} }'  \textsf{=}   \overline{\mathit{fv} } \!\left[  \ottmv{f}   \mapsto   v  \right]  \hfill  \hfill }%
\ottpremise{\ottnt{h'}  \textsf{=}  \ottnt{h}  \oplus   \left( \iota   \mapsto    \left( T ,  \overline{\mathit{fv} }' \right)  \right) }%
}{
 \ottnt{h} \!\left[  \iota \texttt{.} \ottmv{f} \  := \  v  \right]\  \textsf{=} \  \ottnt{h'} }{%
{\ottdrulename{hup\_refT}}{}%
}}


\newcommand{\ottdrulehupXXprimT}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{h} \!\left(  \iota  \right)   \textsf{=}   \left( T ,  \overline{\mathit{fv} } \right)   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \overline{\mathit{fv} } \!\left(  \ottmv{f}  \right)   \textsf{=}   ( \ottnt{q'} ,  {^r}\!\mathcal{L}' )  \hfill }%
\ottpremise{ \hfill  \overline{\mathit{fv} }'  \textsf{=}   \overline{\mathit{fv} } \!\left[  \ottmv{f}   \mapsto    ( \ottnt{q'} ,  {^r}\!\mathcal{L} )   \right]   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  \ottnt{h'}  \textsf{=}  \ottnt{h}  \oplus   \left( \iota   \mapsto    \left( T ,  \overline{\mathit{fv} }' \right)  \right)  \hfill }%
}{
 \ottnt{h} \!\left[  \iota \texttt{.} \ottmv{f} \  := \   ( \ottnt{q} ,  {^r}\!\mathcal{L} )   \right]\  \textsf{=} \  \ottnt{h'} }{%
{\ottdrulename{hup\_primT}}{}%
}}

\newcommand{\ottdefnupdate}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{h} \!\left[  \iota \texttt{.} \ottmv{f} \  := \  v  \right]\  \textsf{=} \  \ottnt{h'} $}{\ottcom{field update in heap}}
\ottusedrule{\ottdrulehupXXrefT{}}
\ottusedrule{\ottdrulehupXXprimT{}}
\end{ottdefnblock}}


% defn sT_rT
\newcommand{\ottdrulesTrTXXrefT}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{q}  \textsf{=}   \texttt{\upshape{context}\,\!}   \textsf{$\implies$}  \ottnt{q'}  \textsf{=}   \mathrm{TQual}\!\left(   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \right) }%
\ottpremise{\ottnt{q}  \textsf{$\not=$}   \texttt{\upshape{context}\,\!}   \textsf{$\implies$}  \ottnt{q'}  \textsf{=}  \ottnt{q}}%
}{
 \mathrm{sTrT}\!\left( \ottnt{h} ,  \iota ,    \ottnt{q} \  \ottnt{C}   \right)\  \textsf{=} \    \ottnt{q'} \  \ottnt{C}   }{%
{\ottdrulename{sTrT\_refT}}{}%
}}


\newcommand{\ottdrulesTrTXXprimT}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{q}  \textsf{=}   \texttt{\upshape{context}\,\!}   \textsf{$\implies$}  \ottnt{q'}  \textsf{=}   \mathrm{TQual}\!\left(   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \right) }%
\ottpremise{\ottnt{q}  \textsf{$\not=$}   \texttt{\upshape{context}\,\!}   \textsf{$\implies$}  \ottnt{q'}  \textsf{=}  \ottnt{q}}%
}{
 \mathrm{sTrT}\!\left( \ottnt{h} ,  \iota ,    \ottnt{q} \  \ottnt{P}   \right)\  \textsf{=} \    \ottnt{q'} \  \ottnt{P}   }{%
{\ottdrulename{sTrT\_primT}}{}%
}}

\newcommand{\ottdefnsTXXrT}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{sTrT}\!\left( \ottnt{h} ,  \iota ,  T \right)\  \textsf{=} \  T' $}{\ottcom{convert type $T$ to its runtime equivalent $T'$}}
\ottusedrule{\ottdrulesTrTXXrefT{}}
\ottusedrule{\ottdrulesTrTXXprimT{}}
\end{ottdefnblock}}


% defn rttyping
\newcommand{\ottdrulerttXXaddr}[1]{\ottdrule[#1]{%
\ottpremise{ \mathrm{sTrT}\!\left( \ottnt{h} ,  \iota_{{\mathrm{0}}} ,    \ottnt{q} \  \ottnt{C}   \right)\  \textsf{=} \    \ottnt{q'} \  \ottnt{C}   }%
\ottpremise{ \hfill   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \textsf{=}  T_{{\mathrm{1}}}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   T_{{\mathrm{1}}} \  \textsf{$<:$} \ \    \ottnt{q'} \  \ottnt{C}    \hfill }%
}{
 \ottnt{h} ,  \iota_{{\mathrm{0}}} \  \textsf{$\vdash$} \  \iota \  \textsf{:} \ \    \ottnt{q} \  \ottnt{C}   }{%
{\ottdrulename{rtt\_addr}}{}%
}}


\newcommand{\ottdrulerttXXnull}[1]{\ottdrule[#1]{%
}{
 \ottnt{h} ,  \iota_{{\mathrm{0}}} \  \textsf{$\vdash$} \  \texttt{\upshape{null$_a$}\,\!} \  \textsf{:} \ \    \ottnt{q} \  \ottnt{C}   }{%
{\ottdrulename{rtt\_null}}{}%
}}


\newcommand{\ottdrulerttXXprimT}[1]{\ottdrule[#1]{%
\ottpremise{ \mathrm{sTrT}\!\left( \ottnt{h} ,  \iota_{{\mathrm{0}}} ,    \ottnt{q'} \  \ottnt{P}   \right)\  \textsf{=} \    \ottnt{q''} \  \ottnt{P}   }%
\ottpremise{ \hfill  {^r}\!\mathcal{L} \, \textsf{$\in$} \, \ottnt{P}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill     \ottnt{q} \  \ottnt{P}   \  \textsf{$<:$} \ \    \ottnt{q''} \  \ottnt{P}    \hfill }%
}{
 \ottnt{h} ,  \iota_{{\mathrm{0}}} \  \textsf{$\vdash$} \   ( \ottnt{q} ,  {^r}\!\mathcal{L} )  \  \textsf{:} \ \    \ottnt{q'} \  \ottnt{P}   }{%
{\ottdrulename{rtt\_primT}}{}%
}}

\newcommand{\ottdefnrttyping}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  v \  \textsf{:} \ \  T $}{\ottcom{type $T$ assignable to value $v$}}
\ottusedrule{\ottdrulerttXXaddr{}}
\ottusedrule{\ottdrulerttXXnull{}}
\ottusedrule{\ottdrulerttXXprimT{}}
\end{ottdefnblock}}


% defn rtsttypings
\newcommand{\ottdrulerttsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottcomp{ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  v_{\ottmv{i}} \  \textsf{:} \ \  T_{\ottmv{i}} }{\ottmv{i}}}%
}{
 \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \ottcomp{v_{\ottmv{i}}}{\ottmv{i}} \  \textsf{:} \ \  \ottcomp{T_{\ottmv{i}}}{\ottmv{i}} }{%
{\ottdrulename{rtts\_def}}{}%
}}

\newcommand{\ottdefnrtsttypings}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \overline{v} \  \textsf{:} \ \  \overline{T} $}{\ottcom{types $\overline{T}$ assignable to values $\overline{v}$}}
\ottusedrule{\ottdrulerttsXXdef{}}
\end{ottdefnblock}}


% defn rftype
\newcommand{\ottdrulerftXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \iota \  \textsf{:} \ \    \ottnt{q} \  \ottnt{C}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{FType}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottmv{f} \right)\  \textsf{=} \  T  \hfill }%
}{
 \mathrm{FType}\!\left( \ottnt{h} ,  \iota ,  \ottmv{f} \right)\  \textsf{=} \  T }{%
{\ottdrulename{rft\_def}}{}%
}}

\newcommand{\ottdefnrftype}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{FType}\!\left( \ottnt{h} ,  \iota ,  \ottmv{f} \right)\  \textsf{=} \  T $}{\ottcom{look up type of field in heap}}
\ottusedrule{\ottdrulerftXXdef{}}
\end{ottdefnblock}}


% defn rmsign
\newcommand{\ottdrulermsXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \iota \  \textsf{:} \ \    \ottnt{q} \  \ottnt{C}     \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MSig}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms}  \hfill }%
}{
 \mathrm{MSig}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms} }{%
{\ottdrulename{rms\_def}}{}%
}}

\newcommand{\ottdefnrmsign}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{MSig}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{ms} $}{\ottcom{look up method signature of method $\ottnt{m}$ at $\iota$}}
\ottusedrule{\ottdrulermsXXdef{}}
\end{ottdefnblock}}


% defn smbodyc
\newcommand{\ottdrulesmbcXXfound}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \   \texttt{\_}  \  \texttt{\{} \   \texttt{\_}  \   \texttt{\_}  \,  \ottnt{ms}  \  \texttt{\{} \  \ottnt{e} \  \texttt{\}\,}  \,  \texttt{\_}  \  \texttt{\}\,}  \, \textsf{$\in$} \, \ottnt{Prg}}%
\ottpremise{  \mathrm{MName}\!\left(  \ottnt{ms}  \right)   \textsf{=}  \ottnt{m} \ \  \textsf{$\wedge$} \ \   \mathrm{MQual}\!\left(  \ottnt{ms}  \right)   \textsf{=}  \ottnt{q} }%
}{
 \mathrm{MBody}\!\left( \mathit{Cid} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{e} }{%
{\ottdrulename{smbc\_found}}{}%
}}


\newcommand{\ottdrulesmbcXXinh}[1]{\ottdrule[#1]{%
\ottpremise{ \texttt{\upshape{class}\,\!} \  \mathit{Cid} \  \texttt{\upshape{extends}\,\!} \  \ottnt{C_{{\mathrm{1}}}} \  \texttt{\{} \   \texttt{\_}  \  \ottcomp{ \ottnt{ms_{\ottmv{n}}}  \  \texttt{\{} \  \ottnt{e_{\ottmv{n}}} \  \texttt{\}\,} }{\ottmv{n}} \  \texttt{\}\,}  \, \textsf{$\in$} \, \ottnt{Prg}}%
\ottpremise{ \hfill  \ottcomp{ \mathrm{MName}\!\left(  \ottnt{ms_{\ottmv{n}}}  \right)   \textsf{$\not=$}  \ottnt{m}}{\ottmv{n}}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MBody}\!\left( \ottnt{C_{{\mathrm{1}}}} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{e}  \hfill }%
}{
 \mathrm{MBody}\!\left( \mathit{Cid} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{e} }{%
{\ottdrulename{smbc\_inh}}{}%
}}

\newcommand{\ottdefnsmbodyc}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{MBody}\!\left( \ottnt{C} ,  \ottnt{m} ,  \ottnt{q} \right)\  \textsf{=} \  \ottnt{e} $}{\ottcom{look up most-concrete body of $\ottnt{m}$, $\ottnt{q}$ in class $\ottnt{C}$ or a superclass}}
\ottusedrule{\ottdrulesmbcXXfound{}}
\ottusedrule{\ottdrulesmbcXXinh{}}
\end{ottdefnblock}}


% defn rmbody
\newcommand{\ottdrulermbXXcallOne}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \textsf{=}     \texttt{\upshape{precise}\,\!}  \  \ottnt{C}    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MBody}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{precise}\,\!}  \right)\  \textsf{=} \  \ottnt{e}  \hfill }%
}{
 \mathrm{MBody}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e} }{%
{\ottdrulename{rmb\_call1}}{}%
}}


\newcommand{\ottdrulermbXXcallTwo}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \textsf{=}     \texttt{\upshape{approx}\,\!}  \  \ottnt{C}    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MBody}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{approx}\,\!}  \right)\  \textsf{=} \  \ottnt{e}  \hfill }%
}{
 \mathrm{MBody}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e} }{%
{\ottdrulename{rmb\_call2}}{}%
}}


\newcommand{\ottdrulermbXXcallThree}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \textsf{=}     \texttt{\upshape{approx}\,\!}  \  \ottnt{C}    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MBody}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{approx}\,\!}  \right)\  \textsf{=} \   \textit{None}   \hfill }%
\ottpremise{ \mathrm{MBody}\!\left( \ottnt{C} ,  \ottnt{m} ,   \texttt{\upshape{precise}\,\!}  \right)\  \textsf{=} \  \ottnt{e} }%
}{
 \mathrm{MBody}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e} }{%
{\ottdrulename{rmb\_call3}}{}%
}}

\newcommand{\ottdefnrmbody}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{MBody}\!\left( \ottnt{h} ,  \iota ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e} $}{\ottcom{look up most-concrete body of method $\ottnt{m}$ at $\iota$}}
\ottusedrule{\ottdrulermbXXcallOne{}}
\ottusedrule{\ottdrulermbXXcallTwo{}}
\ottusedrule{\ottdrulermbXXcallThree{}}
\end{ottdefnblock}}


% defn fvsinit
\newcommand{\ottdrulefvsiXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\ottnt{q} \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{precise}\,\!}   \ottsym{,}   \texttt{\upshape{approx}\,\!}   \right\} }%
\ottpremise{ \forall  \ottmv{f}  \in   \mathrm{refFields}\!\left( \ottnt{C} \right)  .\   \overline{\mathit{fv} } \!\left(  \ottmv{f}  \right)   \textsf{=}  \texttt{\upshape{null$_a$}\,\!} }%
\ottpremise{ \forall  \ottmv{f}  \in   \mathrm{primFields}\!\left( \ottnt{C} \right)  .\   (   \mathrm{FType}\!\left(  \ottnt{q} \  \ottnt{C}  ,  \ottmv{f} \right)\  \textsf{=} \    \ottnt{q'} \  \ottnt{P}    \ \  \textsf{$\wedge$} \ \   \overline{\mathit{fv} } \!\left(  \ottmv{f}  \right)   \textsf{=}   ( \ottnt{q'} ,  0 )   )  }%
}{
 \mathrm{FVsInit}\!\left(  \ottnt{q} \  \ottnt{C}  \right)\  \textsf{=} \  \overline{\mathit{fv} } }{%
{\ottdrulename{fvsi\_def}}{}%
}}

\newcommand{\ottdefnfvsinit}[1]{\begin{ottdefnblock}[#1]{$ \mathrm{FVsInit}\!\left( \ottnt{qC} \right)\  \textsf{=} \  \overline{\mathit{fv} } $}{\ottcom{initialize the fields for reference type $\ottnt{qC}$}}
\ottusedrule{\ottdrulefvsiXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnsrtXXhelpers}{
\ottdefncreation{}
\ottdefnupdate{}
\ottdefnsTXXrT{}
\ottdefnrttyping{}
\ottdefnrtsttypings{}
\ottdefnrftype{}
\ottdefnrmsign{}
\ottdefnsmbodyc{}
\ottdefnrmbody{}
\ottdefnfvsinit{}}


% defns semantics
% defn semantics
\newcommand{\ottdruleosXXnull}[1]{\ottdrule[#1]{%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \texttt{\upshape{null}\,\!} \ \leadsto\  \ottnt{h} ,  \texttt{\upshape{null$_a$}\,\!} }{%
{\ottdrulename{os\_null}}{}%
}}


\newcommand{\ottdruleosXXliteral}[1]{\ottdrule[#1]{%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \mathcal{L} \ \leadsto\  \ottnt{h} ,   (  \texttt{\upshape{precise}\,\!}  ,  {^r}\!\mathcal{L} )  }{%
{\ottdrulename{os\_literal}}{}%
}}


\newcommand{\ottdruleosXXvar}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \!\left( \ottnt{x} \right)   \textsf{=}  v}%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{x} \ \leadsto\  \ottnt{h} ,  v }{%
{\ottdrulename{os\_var}}{}%
}}


\newcommand{\ottdruleosXXnew}[1]{\ottdrule[#1]{%
\ottpremise{ \mathrm{sTrT}\!\left( \ottnt{h} ,   \mathit{ {^r}\!\Gamma} \!\left( \texttt{\upshape{this}\,\!} \right)  ,    \ottnt{q} \  \ottnt{C}   \right)\  \textsf{=} \    \ottnt{q'} \  \ottnt{C}   }%
\ottpremise{ \mathrm{FVsInit}\!\left(  \ottnt{q'} \  \ottnt{C}  \right)\  \textsf{=} \  \overline{\mathit{fv} } }%
\ottpremise{ \ottnt{h}  +   \left(   \ottnt{q'} \  \ottnt{C}   ,  \overline{\mathit{fv} } \right)  \ =\ \left( \ottnt{h'} ,  \iota \right) }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{new}\,\!} \   \ottnt{q} \  \ottnt{C}  \texttt{(} \texttt{)}  \ \leadsto\  \ottnt{h'} ,  \iota }{%
{\ottdrulename{os\_new}}{}%
}}


\newcommand{\ottdruleosXXread}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto\  \ottnt{h'} ,  \iota_{{\mathrm{0}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{h'} \!\left( \iota_{{\mathrm{0}}} \texttt{.} \ottmv{f} \right)   \textsf{=}  v \hfill }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f}  \ \leadsto\  \ottnt{h'} ,  v }{%
{\ottdrulename{os\_read}}{}%
}}


\newcommand{\ottdruleosXXwrite}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto\  \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{1}}}} \ \leadsto\  \ottnt{h_{{\mathrm{1}}}} ,  v  \hfill }%
\ottpremise{ \ottnt{h_{{\mathrm{1}}}} \!\left[  \iota_{{\mathrm{0}}} \texttt{.} \ottmv{f} \  := \  v  \right]\  \textsf{=} \  \ottnt{h'} }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f} \  := \  \ottnt{e_{{\mathrm{1}}}}  \ \leadsto\  \ottnt{h'} ,  v }{%
{\ottdrulename{os\_write}}{}%
}}


\newcommand{\ottdruleosXXcall}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto\  \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \ \leadsto\  \ottnt{h_{{\mathrm{1}}}} ,  \ottcomp{v_{\ottmv{i}}}{\ottmv{i}}  \hfill }%
\ottpremise{ \hfill   \mathrm{MBody}\!\left( \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}} ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MSig}\!\left( \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}} ,  \ottnt{m} \right)\  \textsf{=} \    \texttt{\_}  \  \ottnt{m} \texttt{(}   \ottcomp{  \texttt{\_}  \  \mathit{pid} }{\ottmv{i}}   \texttt{)} \  \ottnt{q}   \hfill }%
\ottpremise{\mathit{ {^r}\!\Gamma}'  \textsf{=}   \left\{   \texttt{\upshape{precise}\,\!}  ;   \texttt{\upshape{this}\,\!}   \mapsto   \iota_{{\mathrm{0}}}   \ottsym{,} \, \ottcomp{ \mathit{pid}   \mapsto   v_{\ottmv{i}} }{\ottmv{i}}  \right\} }%
\ottpremise{ \mathit{ {^r}\!\Gamma}' \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{1}}}} ,  \ottnt{e} \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}}  \texttt{)} \ \leadsto\  \ottnt{h'} ,  v }{%
{\ottdrulename{os\_call}}{}%
}}


\newcommand{\ottdruleosXXcast}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto\  \ottnt{h'} ,  v }%
\ottpremise{ \ottnt{h'} ,   \mathit{ {^r}\!\Gamma} \!\left( \texttt{\upshape{this}\,\!} \right)  \  \textsf{$\vdash$} \  v \  \textsf{:} \ \    \ottnt{q} \  \ottnt{C}   }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{(}  \ottnt{q} \  \ottnt{C}  \texttt{)} \  \ottnt{e}  \ \leadsto\  \ottnt{h'} ,  v }{%
{\ottdrulename{os\_cast}}{}%
}}


\newcommand{\ottdruleosXXprimop}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto\  \ottnt{h_{{\mathrm{0}}}} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{0}}} )  }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{1}}}} \ \leadsto\  \ottnt{h'} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{1}}} )  }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}}  \oplus  \ottnt{e_{{\mathrm{1}}}} \ \leadsto\  \ottnt{h'} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{0}}}  \oplus  {^r}\!\mathcal{L}_{{\mathrm{1}}} )  }{%
{\ottdrulename{os\_primop}}{}%
}}


\newcommand{\ottdruleosXXcondXXt}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto\  \ottnt{h_{{\mathrm{0}}}} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L} )    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  {^r}\!\mathcal{L}  \textsf{$\not=$}  0 \hfill }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{1}}}} \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \ \leadsto\  \ottnt{h'} ,  v }{%
{\ottdrulename{os\_cond\_t}}{}%
}}


\newcommand{\ottdruleosXXcondXXf}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto\  \ottnt{h_{{\mathrm{0}}}} ,   ( \ottnt{q} ,  0 )    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{2}}}} \ \leadsto\  \ottnt{h'} ,  v  \hfill }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \ \leadsto\  \ottnt{h'} ,  v }{%
{\ottdrulename{os\_cond\_f}}{}%
}}


\newcommand{\ottdruleosXXapprox}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto\  \ottnt{h'} ,  v   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{h'}  \cong   \tilde{ \ottnt{h'} }   \hfill   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   v  \cong   \tilde{ v }   \hfill }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto\   \tilde{ \ottnt{h'} }  ,   \tilde{ v }  }{%
{\ottdrulename{os\_approx}}{}%
}}

\newcommand{\ottdefnsemantics}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto\  \ottnt{h'} ,  v $}{\ottcom{big-step operational semantics}}
\ottusedrule{\ottdruleosXXnull{}}
\ottusedrule{\ottdruleosXXliteral{}}
\ottusedrule{\ottdruleosXXvar{}}
\ottusedrule{\ottdruleosXXnew{}}
\ottusedrule{\ottdruleosXXread{}}
\ottusedrule{\ottdruleosXXwrite{}}
\ottusedrule{\ottdruleosXXcall{}}
\ottusedrule{\ottdruleosXXcast{}}
\ottusedrule{\ottdruleosXXprimop{}}
\ottusedrule{\ottdruleosXXcondXXt{}}
\ottusedrule{\ottdruleosXXcondXXf{}}
\ottusedrule{\ottdruleosXXapprox{}}
\end{ottdefnblock}}


% defn semantics_many
\newcommand{\ottdruleossXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto\  \ottnt{h_{{\mathrm{0}}}} ,  v }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \ \leadsto\  \ottnt{h'} ,  \ottcomp{v_{\ottmv{i}}}{\ottmv{i}} }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e}  \ottsym{,} \, \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \ \leadsto\  \ottnt{h'} ,  v  \ottsym{,} \, \ottcomp{v_{\ottmv{i}}}{\ottmv{i}} }{%
{\ottdrulename{oss\_def}}{}%
}}


\newcommand{\ottdruleossXXempty}[1]{\ottdrule[#1]{%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \emptyset  \ \leadsto\  \ottnt{h} ,   \emptyset  }{%
{\ottdrulename{oss\_empty}}{}%
}}

\newcommand{\ottdefnsemanticsXXmany}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \overline{e} \ \leadsto\  \ottnt{h'} ,  \overline{v} $}{\ottcom{sequential big-step operational semantics}}
\ottusedrule{\ottdruleossXXdef{}}
\ottusedrule{\ottdruleossXXempty{}}
\end{ottdefnblock}}


% defn semantics_prg
\newcommand{\ottdruleospXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \mathrm{FVsInit}\!\left(   \texttt{\upshape{precise}\,\!}  \  \ottnt{C}  \right)\  \textsf{=} \  \overline{\mathit{fv} } }%
\ottpremise{  \emptyset   +   \left(    \texttt{\upshape{precise}\,\!}  \  \ottnt{C}   ,  \overline{\mathit{fv} } \right)  \ =\ \left( \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}} \right) }%
\ottpremise{ \hfill  \mathit{ {^r}\!\Gamma}_{{\mathrm{0}}}  \textsf{=}   \left\{   \texttt{\upshape{precise}\,\!}  ;   \texttt{\upshape{this}\,\!}   \mapsto   \iota_{{\mathrm{0}}}   \right\}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma}_{{\mathrm{0}}} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e} \ \leadsto\  \ottnt{h} ,  v  \hfill }%
}{
 \textsf{$\vdash$} \   \overline{\mathit{Cls} } ,\  \ottnt{C} ,\  \ottnt{e}  \ \leadsto\  \ottnt{h} ,  v }{%
{\ottdrulename{osp\_def}}{}%
}}

\newcommand{\ottdefnsemanticsXXprg}[1]{\begin{ottdefnblock}[#1]{$ \textsf{$\vdash$} \  \ottnt{Prg} \ \leadsto\  \ottnt{h} ,  v $}{\ottcom{big-step operational semantics of a program}}
\ottusedrule{\ottdruleospXXdef{}}
\end{ottdefnblock}}


% defn checkedsemantics
\newcommand{\ottdrulecosXXnull}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \texttt{\upshape{null}\,\!} \ \leadsto\  \ottnt{h} ,  \texttt{\upshape{null$_a$}\,\!} }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \texttt{\upshape{null}\,\!} \ \leadsto_{c}\  \ottnt{h} ,  \texttt{\upshape{null$_a$}\,\!} }{%
{\ottdrulename{cos\_null}}{}%
}}


\newcommand{\ottdrulecosXXliteral}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \mathcal{L} \ \leadsto\  \ottnt{h} ,   (  \texttt{\upshape{precise}\,\!}  ,  {^r}\!\mathcal{L} )  }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \mathcal{L} \ \leadsto_{c}\  \ottnt{h} ,   (  \texttt{\upshape{precise}\,\!}  ,  {^r}\!\mathcal{L} )  }{%
{\ottdrulename{cos\_literal}}{}%
}}


\newcommand{\ottdrulecosXXvar}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{x} \ \leadsto\  \ottnt{h} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{x} \ \leadsto_{c}\  \ottnt{h} ,  v }{%
{\ottdrulename{cos\_var}}{}%
}}


\newcommand{\ottdrulecosXXnew}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{new}\,\!} \   \ottnt{q} \  \ottnt{C}  \texttt{(} \texttt{)}  \ \leadsto\  \ottnt{h'} ,  \iota }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{new}\,\!} \   \ottnt{q} \  \ottnt{C}  \texttt{(} \texttt{)}  \ \leadsto_{c}\  \ottnt{h'} ,  \iota }{%
{\ottdrulename{cos\_new}}{}%
}}


\newcommand{\ottdrulecosXXread}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto_{c}\  \ottnt{h'} ,  \iota_{{\mathrm{0}}} }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f}  \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f}  \ \leadsto_{c}\  \ottnt{h'} ,  v }{%
{\ottdrulename{cos\_read}}{}%
}}


\newcommand{\ottdrulecosXXwrite}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \ottnt{h} \!\left( \iota_{{\mathrm{0}}} \right)\!\!\downarrow_{1}   \textsf{=}    \ottnt{q} \  \ottnt{C}   \hfill }%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \!\!\downarrow_{1}   \textsf{=}  \ottnt{q'}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   (  \ottnt{q}  \textsf{=}  \ottnt{q'} \ \  \textsf{$\vee$} \ \  \ottnt{q'}  \textsf{=}   \texttt{\upshape{precise}\,\!}   )  \hfill }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{1}}}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{1}}}} ,  v }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f} \  := \  \ottnt{e_{{\mathrm{1}}}}  \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \ottnt{e_{{\mathrm{0}}}} \texttt{.} \ottmv{f} \  := \  \ottnt{e_{{\mathrm{1}}}}  \ \leadsto_{c}\  \ottnt{h'} ,  v }{%
{\ottdrulename{cos\_write}}{}%
}}


\newcommand{\ottdrulecosXXcall}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{1}}}} ,  \ottcomp{v_{\ottmv{i}}}{\ottmv{i}}  \hfill }%
\ottpremise{ \hfill   \mathrm{MBody}\!\left( \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}} ,  \ottnt{m} \right)\  \textsf{=} \  \ottnt{e}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathrm{MSig}\!\left( \ottnt{h_{{\mathrm{0}}}} ,  \iota_{{\mathrm{0}}} ,  \ottnt{m} \right)\  \textsf{=} \    \texttt{\_}  \  \ottnt{m} \texttt{(}   \ottcomp{  \texttt{\_}  \  \mathit{pid} }{\ottmv{i}}   \texttt{)} \  \ottnt{q}   \hfill }%
\ottpremise{\mathit{ {^r}\!\Gamma}'  \textsf{=}   \left\{   \texttt{\upshape{precise}\,\!}  ;   \texttt{\upshape{this}\,\!}   \mapsto   \iota_{{\mathrm{0}}}   \ottsym{,} \, \ottcomp{ \mathit{pid}   \mapsto   v_{\ottmv{i}} }{\ottmv{i}}  \right\} }%
\ottpremise{ \mathit{ {^r}\!\Gamma}' \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{1}}}} ,  \ottnt{e} \ \leadsto_{c}\  \ottnt{h'} ,  v }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}}  \texttt{)} \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}}  \texttt{.}  \ottnt{m}  \texttt{(}  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}}  \texttt{)} \ \leadsto_{c}\  \ottnt{h'} ,  v }{%
{\ottdrulename{cos\_call}}{}%
}}


\newcommand{\ottdrulecosXXcast}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto_{c}\  \ottnt{h'} ,  v }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{(}  \ottnt{q} \  \ottnt{C}  \texttt{)} \  \ottnt{e}  \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{(}  \ottnt{q} \  \ottnt{C}  \texttt{)} \  \ottnt{e}  \ \leadsto_{c}\  \ottnt{h'} ,  v }{%
{\ottdrulename{cos\_cast}}{}%
}}


\newcommand{\ottdrulecosXXprimop}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{0}}}} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{0}}} )  }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{1}}}} \ \leadsto_{c}\  \ottnt{h'} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{1}}} )  }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}}  \oplus  \ottnt{e_{{\mathrm{1}}}} \ \leadsto\  \ottnt{h'} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{0}}}  \oplus  {^r}\!\mathcal{L}_{{\mathrm{1}}} )  }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}}  \oplus  \ottnt{e_{{\mathrm{1}}}} \ \leadsto_{c}\  \ottnt{h'} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L}_{{\mathrm{0}}}  \oplus  {^r}\!\mathcal{L}_{{\mathrm{1}}} )  }{%
{\ottdrulename{cos\_primop}}{}%
}}


\newcommand{\ottdrulecosXXcondXXt}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{0}}}} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L} )    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  {^r}\!\mathcal{L}  \textsf{$\not=$}  0 \hfill }%
\ottpremise{ \hfill  \mathit{ {^r}\!\Gamma}'  \textsf{=}  \mathit{ {^r}\!\Gamma}  \texttt{(}  \ottnt{q}  \texttt{)}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma}' \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{1}}}} \ \leadsto_{c}\  \ottnt{h'} ,  v  \hfill }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \ \leadsto_{c}\  \ottnt{h'} ,  v }{%
{\ottdrulename{cos\_cond\_t}}{}%
}}


\newcommand{\ottdrulecosXXcondXXf}[1]{\ottdrule[#1]{%
\ottpremise{ \hfill   \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e_{{\mathrm{0}}}} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{0}}}} ,   ( \ottnt{q} ,  {^r}\!\mathcal{L} )    \hfill\hspace{7mm plus 2mm minus 1mm}\hfill  {^r}\!\mathcal{L}  \textsf{=}  0 \hfill }%
\ottpremise{ \hfill  \mathit{ {^r}\!\Gamma}'  \textsf{=}  \mathit{ {^r}\!\Gamma}  \texttt{(}  \ottnt{q}  \texttt{)}  \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^r}\!\Gamma}' \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottnt{e_{{\mathrm{2}}}} \ \leadsto_{c}\  \ottnt{h'} ,  v  \hfill }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \ \leadsto\  \ottnt{h'} ,  v }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \texttt{\upshape{if}\,\!} ( \ottnt{e_{{\mathrm{0}}}} )\  \texttt{\{}   \ottnt{e_{{\mathrm{1}}}}   \texttt{\}\,} \  \texttt{\upshape{else}\,\!} \  \texttt{\{}   \ottnt{e_{{\mathrm{2}}}}   \texttt{\}\,}  \ \leadsto_{c}\  \ottnt{h'} ,  v }{%
{\ottdrulename{cos\_cond\_f}}{}%
}}

\newcommand{\ottdefncheckedsemantics}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto_{c}\  \ottnt{h'} ,  v $}{\ottcom{checked big-step operational semantics}}
\ottusedrule{\ottdrulecosXXnull{}}
\ottusedrule{\ottdrulecosXXliteral{}}
\ottusedrule{\ottdrulecosXXvar{}}
\ottusedrule{\ottdrulecosXXnew{}}
\ottusedrule{\ottdrulecosXXread{}}
\ottusedrule{\ottdrulecosXXwrite{}}
\ottusedrule{\ottdrulecosXXcall{}}
\ottusedrule{\ottdrulecosXXcast{}}
\ottusedrule{\ottdrulecosXXprimop{}}
\ottusedrule{\ottdrulecosXXcondXXt{}}
\ottusedrule{\ottdrulecosXXcondXXf{}}
\end{ottdefnblock}}


% defn checkedsemantics_many
\newcommand{\ottdrulecossXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e} \ \leadsto_{c}\  \ottnt{h_{{\mathrm{0}}}} ,  v }%
\ottpremise{ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h_{{\mathrm{0}}}} ,  \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \ \leadsto_{c}\  \ottnt{h'} ,  \ottcomp{v_{\ottmv{i}}}{\ottmv{i}} }%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \ottnt{e}  \ottsym{,} \, \ottcomp{\ottnt{e_{\ottmv{i}}}}{\ottmv{i}} \ \leadsto_{c}\  \ottnt{h'} ,  v  \ottsym{,} \, \ottcomp{v_{\ottmv{i}}}{\ottmv{i}} }{%
{\ottdrulename{coss\_def}}{}%
}}


\newcommand{\ottdrulecossXXempty}[1]{\ottdrule[#1]{%
}{
 \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,   \emptyset  \ \leadsto_{c}\  \ottnt{h} ,   \emptyset  }{%
{\ottdrulename{coss\_empty}}{}%
}}

\newcommand{\ottdefncheckedsemanticsXXmany}[1]{\begin{ottdefnblock}[#1]{$ \mathit{ {^r}\!\Gamma} \  \textsf{$\vdash$} \  \ottnt{h} ,  \overline{e} \ \leadsto_{c}\  \ottnt{h'} ,  \overline{v} $}{\ottcom{checked sequential big-step operational semantics}}
\ottusedrule{\ottdrulecossXXdef{}}
\ottusedrule{\ottdrulecossXXempty{}}
\end{ottdefnblock}}


\newcommand{\ottdefnssemantics}{
\ottdefnsemantics{}
\ottdefnsemanticsXXmany{}
\ottdefnsemanticsXXprg{}
\ottdefncheckedsemantics{}
\ottdefncheckedsemanticsXXmany{}}


% defns wfruntime
% defn wfheap
\newcommand{\ottdrulewfhXXdef}[1]{\ottdrule[#1]{%
\ottpremise{ \forall  \iota  \in   \mathrm{dom}\!\left(  \ottnt{h}  \right)  ,  \ottmv{f}  \in   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{2}  .\   (   \mathrm{FType}\!\left( \ottnt{h} ,  \iota ,  \ottmv{f} \right)\  \textsf{=} \  T  \ \  \textsf{$\wedge$} \ \   \ottnt{h} ,  \iota \  \textsf{$\vdash$} \   \ottnt{h} \!\left( \iota \texttt{.} \ottmv{f} \right)  \  \textsf{:} \ \  T   )  }%
\ottpremise{ \forall  \iota  \in   \mathrm{dom}\!\left(  \ottnt{h}  \right)  .\   (    \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}  \ \  \textsf{OK}  \ \  \textsf{$\wedge$} \ \   \mathrm{TQual}\!\left(   \ottnt{h} \!\left( \iota \right)\!\!\downarrow_{1}   \right)  \, \textsf{$\in$} \,  \left\{   \texttt{\upshape{precise}\,\!}   \ottsym{,}   \texttt{\upshape{approx}\,\!}   \right\}   )  }%
}{
 \ottnt{h} \ \  \textsf{OK} }{%
{\ottdrulename{wfh\_def}}{}%
}}

\newcommand{\ottdefnwfheap}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{h} \ \  \textsf{OK} $}{\ottcom{well-formed heap}}
\ottusedrule{\ottdrulewfhXXdef{}}
\end{ottdefnblock}}


% defn wfenvs
\newcommand{\ottdrulewfrseXXdef}[1]{\ottdrule[#1]{%
\ottpremise{\mathit{ {^r}\!\Gamma}  \textsf{=}   \left\{   \texttt{\upshape{precise}\,\!}  ;   \texttt{\upshape{this}\,\!}   \mapsto   \iota   \ottsym{,} \, \ottcomp{ \mathit{pid}   \mapsto   v_{\ottmv{i}} }{\ottmv{i}}  \right\} }%
\ottpremise{\mathit{ {^s}\!\Gamma}  \textsf{=}   \left\{   \texttt{\upshape{this}\,\!}   \mapsto      \texttt{\upshape{context}\,\!}  \  \ottnt{C}     \ottsym{,} \, \ottcomp{ \mathit{pid}   \mapsto   T_{\ottmv{i}} }{\ottmv{i}}  \right\} }%
\ottpremise{ \hfill   \ottnt{h} \ \  \textsf{OK}   \hfill\hspace{7mm plus 2mm minus 1mm}\hfill   \mathit{ {^s}\!\Gamma} \ \  \textsf{OK}  \hfill }%
\ottpremise{ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \iota \  \textsf{:} \ \     \texttt{\upshape{context}\,\!}  \  \ottnt{C}   }%
\ottpremise{ \ottnt{h} ,  \iota \  \textsf{$\vdash$} \  \ottcomp{v_{\ottmv{i}}}{\ottmv{i}} \  \textsf{:} \ \  \ottcomp{T_{\ottmv{i}}}{\ottmv{i}} }%
}{
 \ottnt{h} ,  \mathit{ {^r}\!\Gamma} \  \textsf{:} \  \mathit{ {^s}\!\Gamma} \ \  \textsf{OK} }{%
{\ottdrulename{wfrse\_def}}{}%
}}

\newcommand{\ottdefnwfenvs}[1]{\begin{ottdefnblock}[#1]{$ \ottnt{h} ,  \mathit{ {^r}\!\Gamma} \  \textsf{:} \  \mathit{ {^s}\!\Gamma} \ \  \textsf{OK} $}{\ottcom{runtime and static environments correspond}}
\ottusedrule{\ottdrulewfrseXXdef{}}
\end{ottdefnblock}}


\newcommand{\ottdefnswfruntime}{
\ottdefnwfheap{}
\ottdefnwfenvs{}}

\newcommand{\ottdefnss}{
\ottdefnsstsubxing
\ottdefnsqcombdef
\ottdefnsstXXhelpers
\ottdefnstyperules
\ottdefnswfstatic
\ottdefnsrtXXhelpers
\ottdefnssemantics
\ottdefnswfruntime}

\newcommand{\ottall}{\ottmetavars\\[0pt]
\ottgrammar\\[5.0mm]
\ottdefnss
}

